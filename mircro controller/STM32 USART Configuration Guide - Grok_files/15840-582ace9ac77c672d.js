!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0cef0e2b-e9b3-4708-b3bc-1e1705bc9223",e._sentryDebugIdIdentifier="sentry-dbid-0cef0e2b-e9b3-4708-b3bc-1e1705bc9223")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[15840],{5174:(e,t,s)=>{s.d(t,{j:()=>eY});var n=s(79342),i=s(34312),a=s(39188),l=s(82591),r=s(88382);let o=e=>{let{htmlContent:t,width:s="100%",height:i="240",style:a={border:"none",overflow:"hidden",background:"transparent"},onLoad:o}=e,c=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=c.current;if(e){let n=e.contentDocument||e.contentWindow&&e.contentWindow.document;n&&(n.open(),n.write('\n          <html>\n            <body class="iframe-container" style="margin: 0; padding: 0;">\n              '.concat(t,"\n            </body>\n            <style>\n              .iframe-container iframe {\n                width: ").concat(s," !important;\n                height: ").concat(i,"px !important;\n              }\n            </style>\n          </html>\n        ")),n.close())}},[t,i,s]),(0,n.jsx)(l.t,{fallback:(0,n.jsx)("div",{}),children:(0,n.jsx)("iframe",{ref:c,src:"about:blank",width:s,height:i,frameBorder:"0",scrolling:"no",sandbox:"allow-scripts allow-same-origin",style:a,onLoad:o})})};var c=s(61312),d=s(16506);function u(e){let{cardAttachment:t}=e,s=(0,r.useMemo)(()=>{try{let e=new URL(t.url).searchParams.get("v");return"https://www.youtube.com/embed/".concat(e)}catch(e){return null}},[t.url]);return s?(0,n.jsx)(a.p,{className:"w-[-webkit-fill-available] !p-0 overflow-hidden aspect-video mt-2",children:(0,n.jsx)("iframe",{width:"100%",height:"100%",src:s,title:"YouTube video player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0})}):null}function p(e){let{cardAttachments:t}=e,{theme:s}=(0,d.D)();return(0,n.jsx)("div",{className:"flex flex-col justify-between @md/mainview:flex-row gap-2 mt-3 @md/mainview:-mx-4",children:t.map(e=>(0,n.jsxs)("div",{className:(0,c.cn)("relative overflow-hidden rounded-xl flex-1"),children:[(0,n.jsx)("div",{className:"absolute inset-0 rounded-xl border border-[#E8E8E8] dark:border-gray-800 pointer-events-none"}),(0,n.jsx)(o,{htmlContent:'\n            <blockquote\n              class="'.concat((0,c.cn)("reddit-embed-bq","border-border-l1 border p-3 rounded-lg bg-surface-l1 flex gap-1","hover:bg-surface-l4-hover dark:hover:bg-surface-l2 cursor-pointer m-0"),'\n              data-embed-height="240"\n              data-embed-theme="').concat("dark"===s?s:void 0,'"\n              data-embed-showmedia="false"\n\n            >\n              <a\n                class="line-clamp-2 not-italic text-fg-secondary text-sm hover:text-fg-secondary leading-5"\n                href="').concat(e.url,'"\n                target="_blank"\n              >\n                ').concat(e.url,'\n              </a>\n            </blockquote>\n            <script async="true" src="https://embed.reddit.com/widgets.js"><\/script>\n            ')})]},e.url))})}var x=s(27768),h=s(30388),m=s(75500),f=s(41320),g=s(83612),v=s(43893),j=s(44347),y=s(14941),b=s(74995),w=s(65146),N=s(8646),k=s(96554),S=s(52970);let I=k.bL,_=r.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,n.jsx)(k.q7,{ref:t,className:(0,c.cn)(s),...i})});_.displayName="AccordionItem";let C=r.forwardRef((e,t)=>{let{className:s,children:i,hideChevron:a,...l}=e;return(0,n.jsx)(k.Y9,{className:"flex m-0",children:(0,n.jsxs)(k.l9,{ref:t,className:(0,c.cn)("flex flex-1 items-center text-sm font-medium transition-all text-left [&[data-state=open]>svg]:rotate-180",s),...l,children:[i,!a&&(0,n.jsx)(S.D3D,{className:"ml-1 h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})})});C.displayName=k.l9.displayName;let T=r.forwardRef((e,t)=>{let{className:s,children:i,hideChevron:a,...l}=e;return(0,n.jsx)(k.Y9,{className:"z-20 sticky flex m-0 bg-gradient-to-b from-background via-background via-85% to-transparent group top-12 @[1280px]/mainview:top-0 @[1280px]/mainview:z-40",children:(0,n.jsxs)(k.l9,{ref:t,className:(0,c.cn)("flex flex-1 items-center text-sm font-medium transition-all text-left",s),...l,children:[i,!a&&(0,n.jsx)(S.D3D,{className:"ml-1 h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200 group-data-[state=open]:rotate-180"})]})})});T.displayName=k.l9.displayName;let E=r.forwardRef((e,t)=>{let{className:s,children:i,...a}=e;return(0,n.jsx)(k.UC,{ref:t,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:(0,n.jsx)("div",{className:(0,c.cn)("pt-0",s),children:i})})});E.displayName=k.UC.displayName;let A=e=>{let{header:t,responseId:s,index:n}=e,i=t.replace(/[^a-zA-Z0-9\u00C0-\u024F\u0400-\u04FF\u0900-\u097F\u0E00-\u0E7F\u4E00-\u9FFF]/g,"-").toLowerCase();return"".concat(i,"-").concat(s,"-").concat(n)};var R=s(20337),P=s(92539);let z=e=>{var t,s,n;let{uniqueXPosts:i,uniqueWebSearchResults:a,uniqueBrowsedUrls:l}=(0,r.useMemo)(()=>{var t;let{webSearchResults:s,xposts:n,steps:i}=e,a=[...n||[],...(i||[]).flatMap(e=>e.xposts||[])],l=[...s||[],...(i||[]).flatMap(e=>e.webSearchResults||[])],r=new Set,o=a.filter(e=>!(!(null==e?void 0:e.postId)||r.has(e.postId))&&(r.add(e.postId),!0)),c=new Set;return{uniqueXPosts:o,uniqueWebSearchResults:l.filter(e=>!(!(null==e?void 0:e.url)||c.has(e.url))&&(c.add(e.url),!0)),uniqueBrowsedUrls:(null==(t=e.steps)?void 0:t.flatMap(e=>{var t,s,n;if(!(null==(t=e.tags)?void 0:t.includes("decision")))return[];let i=e.tags.indexOf("decision"),a=null==(s=e.text)?void 0:s[i];if(!a)return[];try{let e=JSON.parse(a);if("browse_page"===e.action){let t=null==(n=e.action_input)?void 0:n.url;return t?[t]:[]}}catch(e){}return[]}))||[]}},[null==(t=e.xposts)?void 0:t.length,null==(s=e.webSearchResults)?void 0:s.length,null==(n=e.steps)?void 0:n.length]);return{uniqueXPosts:i,uniqueWebSearchResults:a,uniqueBrowsedUrls:l}};var M=s(56691),O=s(57896),D=s(25969),B=s(58027),U=s(35299),q=s(96534),H=s(86639);let F=e=>{let{post:t}=e;return(0,n.jsxs)("a",{href:"https://x.com/".concat(t.username,"/status/").concat(t.postId),className:"block p-3 flex-shrink-0 w-80 bg-card h-[136px] border not-prose border-card-border hover:border-card-focus hover:bg-card-hover rounded-3xl group/xpost transition-all !no-underline",target:"_blank",rel:"noopener noreferrer",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2 w-full min-w-0",children:[(0,n.jsx)("img",{className:(0,c.cn)("size-8 rounded-full bg-important border border-card-border"),src:t.profileImageUrl,alt:"".concat(t.name,"'s profile")}),(0,n.jsxs)("div",{className:"flex flex-col overflow-hidden flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex gap-1 items-center min-w-0",children:[(0,n.jsxs)("div",{className:"flex gap-1 items-center flex-1 min-w-0 leading-tight",children:[(0,n.jsx)("span",{className:"m-0 truncate text-primary font-medium min-w-0",children:t.name}),(0,n.jsx)("span",{className:"text-xs text-secondary shrink-0",children:"\xb7"}),"string"==typeof t.createTime&&(0,n.jsx)(q.S,{className:"text-xs whitespace-nowrap shrink-0",date:new Date(t.createTime||""),noTooltip:!0})]}),(0,n.jsx)(H.A,{className:"mx-1 size-3 text-secondary group-hover/xpost:text-primary transition-all shrink-0"})]}),(0,n.jsxs)("span",{className:"text-xs text-secondary truncate leading-tight",children:["@",t.username]})]})]}),(0,n.jsx)("p",{className:"text-primary text-xs mt-2 line-clamp-3 mb-0",children:t.text})]})},L=[],W=e=>{var t,s,i;let{isStreaming:a,isOpen:l,step:o,stepIndex:c}=e,{t:d}=(0,w.Bd)("chat"),{client:u}=(0,R.useStatsigClient)(),p=(0,P.aP)(b.A("setSidePanelContent")),x=a?N.Cn:N.Ad,h=(()=>{if(!o.tags||!o.text)return null;let e=o.tags.indexOf("decision");return -1===e?null:JSON.parse(o.text[e])})(),m=(()=>{if(!o.tags||!o.text)return null;let e=o.tags.indexOf("summary");return -1===e?null:o.text[e]})(),f=(0,r.useMemo)(()=>{var e;return(null!=(e=o.webSearchResults)?e:[]).slice(0,5)},[o.webSearchResults]),g=(0,r.useCallback)(()=>{var e;u.logEvent("show_all_research_accordion_search_results",void 0,{location:"searching-step",stepIndex:c.toString()}),o.webSearchResults&&(null==(e=o.webSearchResults)?void 0:e.length)>0&&p({type:"webSearchResults",data:{webSearchResults:o.webSearchResults}})},[o.webSearchResults]),v=(0,r.useCallback)(()=>{var e;o.xposts&&(null==(e=o.xposts)?void 0:e.length)>0&&p({type:"xPosts",data:o.xposts})},[o.xposts]),j=(0,r.useCallback)(()=>{var e,t;(null==h?void 0:h.action)==="browse_page"&&(null==(e=h.action_input)?void 0:e.url)&&window.open(null==(t=h.action_input)?void 0:t.url,"_blank")},[h]);return(0,n.jsxs)(B.N,{children:[l&&(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"overflow-x-auto [&>ul]:m-0 [&>div]:pb-0",children:(0,n.jsx)(x,{sender:"assistant",webSearchResults:o.webSearchResults||L,xposts:o.xposts||L,isNested:!0,children:m||""})},"summary-".concat(c)),o.webSearchResults&&o.webSearchResults.length>0&&(0,n.jsxs)("div",{className:"w-full flex flex-col gap-3 py-3",children:[l&&(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3",children:(0,n.jsx)("ul",{className:"w-full text-primary m-0",children:(0,n.jsx)("li",{children:(0,n.jsx)(w.x6,{ns:"chat",i18nKey:"super-search-searching-for",defaults:'Searching for <bold>"{{query}}"</bold>',values:{query:null==h||null==(t=h.action_input)?void 0:t.query},components:{bold:(0,n.jsx)("strong",{})}})})})},"web-search-results-".concat(c)),(0,n.jsxs)("div",{className:"relative w-full h-full -ml-4",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 w-4 pointer-events-none bg-gradient-to-r from-background to-transparent"}),(0,n.jsx)("div",{className:"absolute inset-y-0 -right-4 w-4 pointer-events-none bg-gradient-to-l from-background to-transparent"}),l&&(0,n.jsxs)("div",{className:"flex flex-col gap-3 w-[calc(100%+16px)] min-h-0 h-full items-stretch px-4 [&:has(:is(*):nth-last-child(1):not(:first-child))]:pb-2",children:[f.map((e,t)=>(0,n.jsx)(U.P.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn",delay:.05*t},children:(0,n.jsx)("div",{className:"w-full max-w-full overflow-hidden relative",children:(0,n.jsxs)("div",{className:"flex max-w-full items-start",children:[e.favicon?(0,n.jsx)("img",{src:e.favicon,alt:"favicon",className:"m-0 mr-3 w-3 h-3"}):null,(0,n.jsxs)("div",{className:"max-w-full w-full text-primary text-sm whitespace-nowrap overflow-hidden text-ellipsis flex flex-col gap-1 ",children:[(0,n.jsx)("a",{href:e.url,target:"_blank",className:"w-full max-w-full !decoration-transparent leading-4  hover:!decoration-primary text-primary truncate",children:e.title}),(0,n.jsx)("div",{className:"ml-1 text-secondary text-xs leading-4 text-nowrap",children:e.url?(0,O.T)(e.url):void 0})]})]})},e.url)},t)),(0,n.jsx)(M.$n,{onClick:g,variant:"outline",className:"text-secondary hover:text-primary h-auto hover:bg-transparent",children:o.webSearchResults.length<=f.length&&"(".concat(o.webSearchResults.length-f.length,")")?d("See all","See all"):d("See more","See more")+" (".concat(o.webSearchResults.length-f.length,")")})]})]})]}),l&&(null==h?void 0:h.action)==="browse_page"&&h.action_input.url&&(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3",children:(0,n.jsx)("ul",{className:"text-primary m-0",children:(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{children:(0,n.jsx)(w.x6,{ns:"chat",i18nKey:"super-search-box-step.browse-page",defaults:'Browsing <site>{{url}}</site> for <bold>"{{query}}"</bold>',values:{url:(0,O.T)(h.action_input.url),query:h.action_input.query},components:{site:(0,n.jsx)("a",{href:h.action_input.url,target:"_blank",rel:"noopener noreferrer"}),bold:(0,n.jsx)("strong",{})}})}),(0,n.jsx)(D.A,{className:"cursor-pointer transition-all inline ml-2 flex-shrink-0 -mt-0.5 size-4 text-secondary hover:text-primary",onClick:j})]})})},"decision-".concat(c)),o.xposts&&o.xposts.length>0&&(0,n.jsxs)("div",{className:"w-full flex flex-col gap-3 py-3",children:[l&&(0,n.jsxs)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3",children:[(0,n.jsx)("ul",{className:"w-full text-primary m-0",children:(0,n.jsx)("li",{children:(null==h||null==(s=h.action_input)?void 0:s.query)?(0,n.jsx)(w.x6,{ns:"chat",i18nKey:"deep-search-box-step.xposts-with-query",defaults:'Searching on X for <bold>"{{query}}"</bold>',values:{query:null==h||null==(i=h.action_input)?void 0:i.query},components:{bold:(0,n.jsx)("strong",{})}}):d("deep-search-box-step.xposts-without-query","Searching on X for")})}),(0,n.jsx)(M.$n,{variant:"ghostSecondary",size:"sm",className:"rounded-full transition-all mr-0.5",onClick:v,children:d("See all","See all")})]},"xposts-".concat(c)),(0,n.jsxs)("div",{className:"relative w-full h-full -ml-4",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 w-4 pointer-events-none bg-gradient-to-r from-background to-transparent"}),(0,n.jsx)("div",{className:"absolute inset-y-0 -right-4 w-4 pointer-events-none bg-gradient-to-l from-background to-transparent"}),l&&(0,n.jsx)("div",{className:"flex gap-3 w-[calc(100%+16px)] h-full items-stretch overflow-x-auto px-4 [&:has(:is(*):nth-last-child(1):not(:first-child))]:pb-2",children:o.xposts.map((e,t)=>(0,n.jsx)(U.P.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn",delay:.05*t},children:(0,n.jsx)(F,{post:e})},t))})]})]})]})};var K=s(43086),V=s(78276);let $=e=>{let{header:t,isComplete:s}=e;return(0,n.jsxs)(C,{className:"flex items-center gap-2",children:[(0,n.jsx)(B.N,{children:s?(0,n.jsx)(U.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex-shrink-0 flex items-center",children:(0,n.jsx)(V.A,{className:"text-secondary size-[22px] flex-shrink-0"})},"check"):(0,n.jsx)(U.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex-shrink-0 flex items-center",children:(0,n.jsx)(K.y,{size:"sm"})},"spinner")}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("div",{className:"truncate text-base font-medium max-w-full",children:s?t:(0,n.jsx)(U.P.div,{className:"text-transparent bg-clip-text bg-gradient-to-r from-secondary via-secondary-foreground to-secondary",style:{backgroundSize:"200% 100%"},animate:{backgroundPosition:["100% 0%","-100% 0%"]},transition:{duration:1,ease:"linear",repeat:Number.POSITIVE_INFINITY},children:t})})})]})};var Y=s(43654);let G=e=>{let{children:t}=e;return(0,n.jsxs)(U.P.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-[3.5rem] overflow-y-clip flex flex-col justify-start text-white rounded-2xl relative w-full overflow-clip foucs:outline-none focus-within:outline-none",children:[t,(0,n.jsx)(S.D3D,{className:"absolute right-5 top-5 h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200 group-data-[state=open]:rotate-180"})]})};function J(e){let{thinkingTrace:t="",className:s}=e,i=t.split(/\r?\n/).filter(Boolean),a=Math.min(i.length,12),l=i.slice(-a);return(0,n.jsx)("div",{className:(0,c.cn)("w-full overflow-hidden relative flex flex-col items-start","h-[180px]",s),children:(0,n.jsxs)(B.N,{mode:"popLayout",children:["(",(0,n.jsx)(U.P.div,{layout:"position",initial:{filter:"blur(8px)"},animate:{filter:"blur(0px)"},transition:{duration:1,ease:"easeOut"},className:(0,c.cn)("w-full flex flex-col items-center justify-center relative px-4 h-full","fade-mask"),children:l.map((e,t)=>(0,n.jsx)(U.P.p,{layout:"position",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"w-full text-secondary text-[12px] opacity-90 my-0 flex items-center",transition:{duration:.3,ease:"easeOut"},children:e},i.length-l.length+t))}),")"]})})}var X=s(97377),Z=s(70907);let Q=e=>{let{isThinking:t,startTime:s,endTime:i,sourcesCount:a,open:l,hasError:o,setOpen:d,children:u,thinkingTrace:p,type:x,inlineButtonText:m,onClickShow:f,progressReport:g,deepsearchPreset:v}=e,{t:j}=(0,w.Bd)("chat"),[y,b]=(0,r.useState)(void 0),N=(0,r.useCallback)(()=>{d(!l)},[l,d]),k=(0,r.useMemo)(()=>s&&i,[s,i]),S=(0,r.useMemo)(()=>s&&i||p&&!s||!t,[s,i,p,t]),C=(0,r.useMemo)(()=>(0,n.jsxs)(n.Fragment,{children:[" ",y&&(0,n.jsx)("span",{className:"font-mono text-secondary font-medium text-sm",children:j("generationTime","{{duration}}s",{duration:y.toFixed(0)})}),!!a&&!t&&(0,n.jsxs)(n.Fragment,{children:[y&&(0,n.jsx)("span",{className:"font-mono text-secondary font-medium text-sm",children:" \xb7 "}),(0,n.jsxs)("span",{className:"text-secondary font-medium text-sm",children:[(0,n.jsx)("span",{className:"font-mono mx-0.5",children:"•"}),(0,n.jsx)("span",{className:"font-mono mx-0.5",children:a}),j("citation sources","Sources")]})]})]}),[y,a,t,j]);(0,r.useEffect)(()=>{if(!s)return;if(!t){s&&i&&b((i-s)/1e3);return}if(i)return void b((i-s)/1e3);let e=setInterval(()=>{b(((i||Date.now())-s)/1e3)},1e3);return()=>clearInterval(e)},[s,i,t]);let A=(0,r.useCallback)(e=>{e.stopPropagation(),null==f||f()},[f]),R=(0,r.useMemo)(()=>{if((null==g?void 0:g.state)==="PROGRESS_REPORT_STATUS_PENDING"&&(null==g?void 0:g.category))return g.category},[g]);return(0,n.jsx)(I,{className:"mb-2",type:"single",collapsible:!0,onValueChange:N,value:l?"root":"",children:(0,n.jsxs)(_,{className:"md:-mx-4 mb-4 relative border-2 border-toggle-border rounded-3xl overflow-clip",value:"root",children:[(0,n.jsx)(T,{hideChevron:!0,className:"text-base space-x-1 transition-padding z-30 duration-200 pt-0 focus:outline-none focus-within:outline-none transition-none",children:(0,n.jsxs)(G,{children:[(0,n.jsxs)("div",{className:"flex h-full gap-1 w-full items-center justify-start text-primary px-5 pt-4",children:[t&&(0,n.jsxs)(U.P.div,{className:"flex gap-1 overflow-hidden",initial:{width:0},animate:{width:"auto"},exit:{width:0},children:[(0,n.jsx)(h.d,{state:R}),(0,n.jsxs)("div",{className:"flex items-baseline gap-1 overflow-hidden",children:[!R&&(0,n.jsx)("span",{className:"loading-gradient-text whitespace-nowrap",children:"think"===x?j("model is thinking response title","Thinking"):"deeper"===v?j("deeper search response title","DeeperSearch"):j("deep search response title","DeepSearch")}),C]})]}),k&&!o&&(0,n.jsx)(U.P.div,{initial:{width:0},animate:{width:"auto"},exit:{width:0},className:"flex items-center gap-2",children:(0,n.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden",children:["think"===x?(0,n.jsx)(Y.xm,{size:16,className:"text-nowrap shrink-0"}):(0,n.jsx)(X.A,{size:16,className:"text-primary text-nowrap shrink-0"}),(0,n.jsxs)("div",{className:"flex items-baseline gap-1 overflow-hidden",children:[(0,n.jsx)("span",{className:"text-base text-nowrap whitespace-nowrap",children:j("Thought for","Thought for")}),C]})]})}),S&&(!k||o)&&(0,n.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden",children:["think"===x?(0,n.jsx)(Y.xm,{size:16,className:"text-primary text-nowrap shrink-0"}):(0,n.jsx)(X.A,{size:16,className:"text-primary text-nowrap shrink-0"}),(0,n.jsxs)("div",{className:"flex items-baseline gap-1 overflow-hidden",children:[(0,n.jsx)("span",{className:"text-base text-nowrap whitespace-nowrap",children:"think"===x?j("thinking response finished title","Thoughts"):"deeper"===v?j("deeper search response finished title","DeeperSearch"):j("deep search response finished title","DeepSearch")}),C]})]})]}),p&&t&&(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:(0,n.jsx)(J,{className:(0,c.cn)(l&&"h-0"),thinkingTrace:p,showMask:!0})}),!S&&l&&f?(0,n.jsx)("span",{className:"text-secondary text-sm my-0 px-5 pb-4 flex flex-row items-center",children:(0,n.jsxs)("span",{className:"cursor-pointer flex flex-row items-center hover:text-primary",onClick:A,children:[m," ",(0,n.jsx)(Z.A,{className:"ml-0.5",size:12})]})}):null,S&&(0,n.jsx)("span",{className:"text-secondary text-sm my-0 px-5 pb-4 flex flex-row items-center",children:l?(0,n.jsxs)(n.Fragment,{children:[j("Collapse details","Collapse details"),f?" • ":"",f?(0,n.jsxs)("span",{className:"cursor-pointer flex flex-row items-center ml-1 hover:text-primary",onClick:A,children:[m," ",(0,n.jsx)(Z.A,{className:"ml-0.5",size:12})]}):null]}):j("Expand for details","Expand for details")})]})}),(0,n.jsx)(E,{className:"text-secondary flex flex-col max-w-full overflow-y-clip",children:u})]})})};function ee(e){var t,s,i,a,l;let{response:o,isStreaming:c}=e,{t:d}=(0,w.Bd)("chat"),{client:u}=(0,R.useStatsigClient)(),[p,x]=(0,r.useState)(!1),[h,m]=(0,r.useState)(""),[f,g]=(0,r.useState)(0),[v,j]=(0,r.useState)(!0),y=(0,P.aP)(b.A("setSidePanelContent")),N=(()=>{if(!o.steps)return[];let e=[];return o.steps.forEach((t,s)=>{var n,i,a,l;if(!t.text.length)return;let r=t.tags.indexOf("header")>-1;if(!r&&0===s)return void e.push({id:A({header:d("deepsearch-thinking","Thinking"),responseId:null!=(n=o.responseId)?n:"",index:s}),header:d("deepsearch-thinking","Thinking"),steps:[t]});if(r){let n=(null==(a=t.text)?void 0:a[(null==(i=t.tags)?void 0:i.indexOf("header"))||0])||"";e.push({id:A({header:n,responseId:null!=(l=o.responseId)?l:"",index:s}),header:n,steps:[t]});return}0!==e.length&&e[e.length-1].steps.push(t)}),e.filter(e=>!!e.steps.length&&e.steps.some(e=>{var t,s;return(null==(t=e.tags)?void 0:t.includes("decision"))||(null==(s=e.tags)?void 0:s.includes("summary"))}))})(),k=e=>e!==N[N.length-1].id||!!o.searchingEndTime||!c,{uniqueXPosts:S,uniqueWebSearchResults:C,uniqueBrowsedUrls:T}=z(o),M=C.length+S.length+T.length,O=null==(l=o.steps)?void 0:l.map(e=>{var t,s,n;if(!(null==(t=e.tags)?void 0:t.includes("assistant")))return"";let i=null==(s=e.tags)?void 0:s.indexOf("assistant");return(null==(n=e.text)?void 0:n[i])||""}).join(" "),D=(0,P.aP)(b.A("sidePanelContent")),B=(null==D?void 0:D.type)==="thinkingTrace"&&D.data.responseId===o.responseId,U=(0,r.useMemo)(()=>{if(null==O?void 0:O.trim())return()=>{var e,t,s,n;if(o.responseId){if(B){u.logEvent("toggle_research_thinking_trace","hidden",{location:"research-response",responseId:null!=(e=o.responseId)?e:"",conversationId:null!=(t=o.conversationId)?t:""}),y(void 0);return}u.logEvent("toggle_research_thinking_trace","shown",{location:"research-response",responseId:null!=(s=o.responseId)?s:"",conversationId:null!=(n=o.conversationId)?n:""}),y({type:"thinkingTrace",data:{responseId:o.responseId}})}}},[o.responseId,D,B,!O]),q=(0,r.useCallback)(e=>{var t,s;e&&j(!1),u.logEvent("expand_research_step",e||"collapsed-all",{location:"research-response",responseId:null!=(t=o.responseId)?t:"",conversationId:null!=(s=o.conversationId)?s:""}),m(e)},[j,u,o,m]);(0,r.useEffect)(()=>{c&&o.searchingStartTime&&x(!0)},[c,o.searchingStartTime]),(0,r.useEffect)(()=>{v&&N.length!==f&&c&&setTimeout(()=>{var e;m(null==(e=N[N.length-1])?void 0:e.id),g(N.length)},800)},[v,f,N,c]),(0,r.useEffect)(()=>{var e;v&&o.searchingEndTime&&h===(null==(e=N[N.length-1])?void 0:e.id)&&m("")},[v,o.searchingEndTime,h,N]);let H=o.thinkingStartTime?new Date(o.thinkingStartTime).getTime():void 0,F=o.thinkingEndTime?new Date(o.thinkingEndTime).getTime():void 0;return o.hasImages||(!o.searchingStartTime||["closed","error"].includes(null!=(s=o.state)?s:""))&&(!o.steps||(null==(t=o.steps)?void 0:t.length)===0)?null:(0,n.jsx)(Q,{type:"deepSearch",isThinking:!!(o.searchingStartTime&&!o.searchingEndTime)&&c,startTime:null!=(i=o.searchingStartTime)?i:H,endTime:null!=(a=o.searchingEndTime)?a:F,sourcesCount:M,open:p,setOpen:x,hasError:"error"===o.state,thinkingTrace:O,onClickShow:U,inlineButtonText:B?d("hide thinking trace","Hide Thinking"):d("show thinking trace","Show Thinking"),progressReport:o.progressReport,deepsearchPreset:o.deepsearchPreset,children:(0,n.jsx)(I,{type:"single",collapsible:!0,value:h,onValueChange:q,className:"flex flex-col w-full pb-3",children:N.map(e=>(0,n.jsxs)(_,{value:e.id,className:"px-4 my-3 w-full",children:[(0,n.jsx)($,{header:e.header,isComplete:k(e.id)}),(0,n.jsx)(E,{className:"flex flex-col pl-7 pt-3",children:e.steps.map((t,s)=>(0,n.jsx)(W,{isStreaming:c,step:t,stepIndex:s,isOpen:h===e.id},s))})]},e.id))})})}let et=[];function es(e){let{response:t,isStreaming:s}=e,i=(0,m.h)(),{client:a}=(0,R.useStatsigClient)(),{sender:l,thinkingTrace:o,webSearchResults:c,xposts:d,liveThinkingStartTime:u,liveThinkingEndTime:p,progressReport:x,deepsearchPreset:h,thinkingStartTime:f,thinkingEndTime:g}=t,v=s?N.Cn:N.Ad,[j,y]=(0,r.useState)(!1),b=(0,r.useCallback)(e=>{var s,n;a.logEvent("toggle_thinking_accordion",e?"open":"closed",{location:"thinking-response",responseId:null!=(s=t.responseId)?s:"",conversationId:null!=(n=t.conversationId)?n:""}),y(e)},[a,y]);(0,r.useEffect)(()=>{i.THINKING_AUTO_OPEN&&s&&u&&y(!0)},[i.THINKING_AUTO_OPEN,s,u]),(0,r.useEffect)(()=>{p&&y(!1)},[p]);let w=f?new Date(f).getTime():void 0,k=g?new Date(g).getTime():void 0;return(o||u)&&(!u||!p||o)?(0,n.jsx)(Q,{type:"think",isThinking:!!(u&&!p)&&s,startTime:null!=u?u:w,endTime:null!=p?p:k,open:j,setOpen:b,hasError:"error"===t.state,thinkingTrace:o,progressReport:x,deepsearchPreset:h,children:(0,n.jsx)(U.P.div,{tabIndex:0,initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,ease:"easeIn"},className:"[&>*:first-child]:mt-0 px-5 h-fit overflow-x-auto w-full focus:outline-none focus-within:outline-none",children:(0,n.jsx)(v,{sender:l||"",webSearchResults:c||et,xposts:d||et,isNested:!0,children:o||""})})}):null}var en=s(80226),ei=s(46741),ea=s(17703),el=s(24405),er=s(72111),eo=s(69458);let ec=[],ed=[];function eu(e){var t,s,i,a,l;let{artifact:o,isStreaming:d,readOnly:u}=e,p=!(0,j.C)(e=>e.userSettings.preferences.hideArtifacts),x=(0,g.sf)(b.A("inlineSettings")),f=(0,m.h)(),{client:v}=(0,R.useStatsigClient)(),y=!p||null!=(a=o.isInline)&&a;p&&o.id&&"boolean"==typeof(null==(t=x[o.id])?void 0:t.isInline)&&(y=x[o.id].isInline);let N=(0,g.sf)(b.A("setInlineSetting")),{setSidePanelContent:k,sidePanelContent:S}=(0,P.aP)(),{t:I}=(0,w.Bd)("chat"),_=(0,r.useCallback)(()=>{!y&&p&&k({type:"artifact",data:{artifact:o,readOnly:u}})},[o,o.content,u,p,k,y]),C=(0,r.useCallback)(async()=>{if(v.logEvent("artifact_show_inline_button_clicked",void 0,{}),o.id&&o.versionId){k(void 0),N(o.id,!0);try{await (0,ei.Ok)({artifactId:o.id,artifactVersionId:o.versionId,isInline:!0})}catch(e){(0,ea.vV)("artifact-onShowInline",e)}}},[o.id,o.versionId]),T=(0,r.useCallback)(async()=>{if(v.logEvent("artifact_show_in_sidebar_button_clicked",void 0,{}),o.id&&o.versionId)try{await (0,ei.Ok)({artifactId:o.id,artifactVersionId:o.versionId,isInline:!1})&&(k({type:"artifact",data:{readOnly:!1,artifact:o}}),N(o.id,!1))}catch(e){(0,ea.vV)("artifact-onShowInASidebar",e)}},[o,N,k,v]),E=(null==S?void 0:S.type)==="artifact"&&o.id===(null==S||null==(s=S.data)?void 0:s.artifact.id)&&o.versionId===(null==S||null==(i=S.data)?void 0:i.artifact.versionId);(0,r.useEffect)(()=>{(null==S?void 0:S.type)==="artifact"&&S.data.artifact.responseId===o.responseId&&S.data.artifact.id===o.id&&_()},[null==o?void 0:o.content]),(0,r.useEffect)(()=>{let e=(null==S?void 0:S.type)==="artifact"&&S.data.artifact.responseId===o.responseId&&S.data.artifact.id;d&&o.content&&!e&&_()},[d,!!o.content]);let A=(0,eo.cY)(o),z=(0,r.useCallback)(()=>{_(),v.logEvent("artifact_card_clicked",void 0,{})},[_,v]);if(y)return(0,n.jsx)(ep,{type:A,content:null!=(l=o.content)?l:"",onShowInASidebar:T});let O=d&&o.incomplete&&!o.title;return(0,n.jsxs)("div",{className:"flex flex-col items-start justify-start gap-2",children:[(0,n.jsx)("div",{className:(0,c.cn)("flex cursor-pointer rounded-2xl border border-border-l1 bg-surface-l2 hover:bg-surface-l4-hover dark:hover:bg-surface-l3",E?"bg-surface-l4-hover dark:bg-surface-l3 hover:bg-surface-l4-hover dark:hover:bg-surface-l3 border-border-l2 cursor-default":void 0,O?"w-[250px]":void 0),onClick:z,id:"artifact_card_".concat(o.versionId),children:O?(0,n.jsxs)("div",{className:"flex w-full items-center space-x-3 p-3",children:[(0,n.jsx)(en.E,{className:"h-8 w-8 rounded-full"}),(0,n.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,n.jsx)(en.E,{className:"h-3.5 w-11/12"}),(0,n.jsx)(en.E,{className:"h-3.5 w-8/12"})]})]}):(0,n.jsxs)("div",{className:"pl-3 pr-5 py-3 flex gap-2",children:[(0,n.jsx)("div",{className:"flex items-center justify-center text-fg-secondary",children:d&&o.incomplete?(0,n.jsx)("div",{className:"flex items-center justify-center w-7 h-8",children:(0,n.jsx)(h.d,{})}):"text/plain"===o.contentType||"text/markdown"===o.contentType?(0,n.jsx)(el.A,{size:28,strokeWidth:1.5}):(0,n.jsx)(er.A,{size:28,strokeWidth:1.5})}),(0,n.jsxs)("div",{className:"leading-[1.3]",children:[(0,n.jsx)("div",{className:"font-medium text-sm",children:o.title}),(0,n.jsx)("div",{className:"text-fg-secondary text-sm",children:A})]})]})}),f.SHOW_ARTIFACTS_INLINE_BUTTON&&!o.incomplete?(0,n.jsx)(M.$n,{variant:"text",size:"none",className:"ml-1 text-fg-secondary hover:text-fg-primary hover:no-underline","aria-label":I("artifact.show.inline.button","Show inline"),onClick:C,children:I("artifact.show.inline.button","Show inline")}):null]})}let ep=e=>{let{type:t,content:s,onShowInASidebar:i}=e,{t:a}=(0,w.Bd)("chat"),l=!(0,j.C)(e=>e.userSettings.preferences.hideArtifacts),[o,d]=(0,r.useState)(!1),u="markdown"!==t&&"plain"!==t&&!!s,p=u?"```".concat(t,"\n").concat(s,"\n```"):s,x=(0,r.useCallback)(()=>{d(!0)},[]),h=(0,r.useCallback)(()=>{d(!1)},[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,c.cn)("transition-opacity",o?"opacity-70":void 0),children:(0,n.jsx)(N.Ad,{sender:"",xposts:ec,webSearchResults:ed,children:p})}),l?(0,n.jsxs)(M.$n,{variant:"secondary",size:"sm",className:"text-fg-secondary hover:text-fg-primary rounded-full mb-2","aria-label":a("artifact.show.in-sidebar.button","Show in sidebar"),onClick:i,onMouseEnter:x,onMouseLeave:h,children:[u?(0,n.jsx)(er.A,{size:16,strokeWidth:1.5}):(0,n.jsx)(el.A,{size:16,strokeWidth:1.5}),a("artifact.show.in-sidebar.button","Show in sidebar"),(0,n.jsx)(Z.A,{size:16,strokeWidth:1.5})]}):null]})};var ex=s(87992),eh=s(87906),em=s(71766),ef=s(43724),eg=s(74495),ev=s(82767),ej=s(67811);let ey=(0,r.forwardRef)((e,t)=>{let{children:s}=e,i=(0,r.useRef)(null),[a,l]=(0,r.useState)(!0),[o,d]=(0,r.useState)(!1),[u,p]=(0,r.useState)(!0),x=(0,r.useRef)(()=>{}),h=(0,j.C)(e=>e.userSettings.preferences.disableAutoScroll),m=(0,r.useCallback)(e=>{i.current&&(d(!1),i.current.scrollTo({top:i.current.scrollHeight,behavior:e}))},[]),f=(0,r.useCallback)(e=>{if(!e)return;let t=document.querySelector('div[data-scrollid="'.concat(e,'"]'));if(!t||!i.current)return;let{top:s}=eb(t,i.current);i.current.scrollTo({top:s,behavior:"smooth"}),l(!1)},[]),g=(0,r.useCallback)(e=>{x.current=e},[]);(0,r.useEffect)(()=>{m("instant")},[]),(0,r.useImperativeHandle)(t,()=>{var e,t,s;return{scrollToId:f,setScrollToIdHandler:g,el:i.current,scrollHeight:null==(e=i.current)?void 0:e.scrollHeight,scrollTop:null==(t=i.current)?void 0:t.scrollTop,clientHeight:null==(s=i.current)?void 0:s.clientHeight}}),(0,r.useEffect)(()=>{if(!i.current)return;let e=new MutationObserver(()=>{if(!i.current)return void d(!1);let e=i.current.scrollHeight-i.current.scrollTop-i.current.clientHeight,t=e<5;if(t!==u&&p(t),d(!a&&e>15),a&&!t&&!h){m("smooth");let e=i.current.querySelectorAll("div[data-scrollid]"),t=e[e.length-1];if(t){var s;let e=null!=(s=t.getAttribute("data-scrollid"))?s:void 0;e&&x.current(e)}}});return e.observe(i.current,{childList:!0,subtree:!0}),()=>{e.disconnect()}},[u,a,h]);let v=(0,r.useCallback)(()=>{l(!1)},[]),y=(0,r.useCallback)(()=>{if(i.current){let e=function(e){return e.scrollHeight<e.scrollTop+e.clientHeight+5}(i.current);e!==u&&p(e),d(!e)}},[u]),b=(0,r.useCallback)(e=>{if(e.deltaY>0&&i.current&&!a){let e=i.current.scrollTop;e+i.current.clientHeight+50>=i.current.scrollHeight&&!h&&l(!0)}if(e.deltaY<0&&a&&v(),!i.current)return;let t=i.current.querySelectorAll("div[data-scrollid]");if(t.length>0){let e,n=i.current.scrollTop,a=i.current.clientHeight,l=i.current.scrollHeight,r=1/0;if(n<20)e=t[0];else if(n+a>=l-20)e=t[t.length-1];else{let s=n+a/2;for(let n of t){let{top:t}=eb(n,i.current);if(s>t&&s<t+n.clientHeight){e=n;break}let a=Math.abs(s-(t+n.clientHeight/2));a<r&&(e=n,r=a)}}if(e){var s;let t=null!=(s=e.getAttribute("data-scrollid"))?s:void 0;x.current(t)}else x.current(void 0)}},[a,h]);return(0,n.jsxs)("div",{ref:i,className:(0,c.cn)("w-full h-full overflow-y-auto overflow-x-hidden scrollbar-gutter-stable no-scrollbar"),onScroll:y,onTouchStart:v,onWheel:b,onDragStart:v,onPointerDown:v,onResize:v,children:[s,o?(0,n.jsx)("div",{className:"absolute flex justify-center w-full h-0 pr-4 mx-auto -top-3",children:(0,n.jsx)("div",{className:(0,c.cn)("h-0 flex items-end justify-end w-full",ev.Q,"px-2 z-40"),children:(0,n.jsx)(M.$n,{onClick:()=>l(!0),variant:"outline",size:"icon",className:"rounded-full bg-input backdrop-blur-sm size-8",children:(0,n.jsx)(ej.A,{size:20,className:"-mb-0.5"})})})}):null]})});function eb(e,t){let s=e.getBoundingClientRect(),n=t.getBoundingClientRect();return{top:s.top-n.top+t.scrollTop,left:s.left-n.left+t.scrollLeft}}var ew=s(82646);let eN=e=>{let{header:t,isActive:s,isComplete:i,onClick:a}=e;return(0,n.jsxs)("div",{className:(0,c.cn)("flex items-start gap-2 group/header",s?void 0:"cursor-pointer"),onClick:a,children:[(0,n.jsx)(B.N,{children:i?(0,n.jsx)(U.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex items-center bg-surface-base",children:(0,n.jsx)(ew.pry,{className:(0,c.cn)("text-primary size-[22px] flex-shrink-0",s?void 0:"opacity-60 group-hover/header:opacity-100")})},"check"):(0,n.jsx)(U.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex-shrink-0 flex items-center bg-background relative z-30",children:(0,n.jsx)(K.y,{size:"sm"})},"spinner")}),(0,n.jsx)("div",{className:"flex items-center text-white",children:(0,n.jsx)("div",{className:(0,c.cn)("text-sm text-primary font-medium max-w-full leading-6",s?void 0:"opacity-60 group-hover/header:opacity-100"),children:i?t:(0,n.jsx)(U.P.div,{style:{backgroundSize:"200% 100%"},animate:{backgroundPosition:["100% 0%","-100% 0%"]},transition:{duration:1,ease:"linear",repeat:Number.POSITIVE_INFINITY},children:t})})})]})},ek=e=>{let{isThinking:t,startTime:s,endTime:i,sourcesCount:a,deepsearchPreset:l}=e,{t:o}=(0,w.Bd)("chat"),[c,d]=(0,r.useState)(void 0),u=s&&i;return(0,r.useEffect)(()=>{if(!s)return;if(!t){s&&i&&d((i-s)/1e3);return}if(i)return void d((i-s)/1e3);let e=setInterval(()=>{d(((i||Date.now())-s)/1e3)},1e3);return()=>clearInterval(e)},[s,i,t]),(0,n.jsxs)("div",{className:"flex flex-col items-start gap-0 text-base space-x-1 transition-padding z-30 duration-200 focus:outline-none focus-within:outline-none transition-none",children:[(0,n.jsx)("div",{className:"flex h-full gap-1 w-full items-center justify-start text-primary px-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden",children:[(0,n.jsx)("div",{className:"w-6 flex items-center justify-center",children:t?(0,n.jsx)(h.d,{}):(0,n.jsx)(X.A,{size:18,className:"text-primary text-nowrap shrink-0"})}),(0,n.jsx)("span",{className:"text-lg text-nowrap font-medium whitespace-nowrap",children:u?o("Completed","Completed"):"deeper"===l?o("DeeperSearch","DeeperSearch"):o("DeepSearch","DeepSearch")})]})}),(0,n.jsxs)("div",{className:"flex items-center justify-center text-nowrap my-0 pl-10 leading-4 text-xs",children:[c&&(0,n.jsx)("span",{className:"text-secondary font-medium",children:function(e){let t=Math.floor(e/60),s=Math.floor(e%60);return 0===t?"".concat(s,"s"):"".concat(t,"m ").concat(s,"s")}(c)}),!!a&&!t&&(0,n.jsxs)(n.Fragment,{children:[c&&(0,n.jsx)("span",{className:"text-secondary font-medium mx-1",children:"\xb7"}),(0,n.jsx)("span",{className:"text-secondary font-medium",children:o("deepsearch-source-count-label",{count:a,defaultValue_one:"{{count}} source",defaultValue_other:"{{count}} sources"})})]})]})]})},eS=e=>{var t,s,i;let{response:a,groups:l,visibleLastStep:o,isStreaming:d,isWide:u,toggleWide:p,scrollToSection:x}=e,{t:h}=(0,w.Bd)("chat"),m=(0,P.aP)(b.A("setSidePanelContent")),f=null==(t=a.steps)?void 0:t.some(e=>{var t;return null==(t=e.tags)?void 0:t.includes("assistant")}),{client:g}=(0,R.useStatsigClient)(),v=(0,r.useCallback)(()=>(g.logEvent("deep_search_trace_click",a.responseId,{location:"super-search-box"}),a.responseId&&m({type:"thinkingTrace",data:{responseId:a.responseId}}),null),[a.responseId]),j=e=>e!==l[l.length-1].id||!!a.searchingEndTime||!d,{uniqueXPosts:y,uniqueWebSearchResults:N,uniqueBrowsedUrls:k}=z(a),S=N.length+y.length+k.length,I=(0,r.useMemo)(()=>l.slice(void 0,-1),[l]),_=(0,r.useMemo)(()=>l[l.length-1],[l]),C=a.thinkingStartTime?new Date(a.thinkingStartTime).getTime():void 0,T=a.thinkingEndTime?new Date(a.thinkingEndTime).getTime():void 0;return(0,n.jsxs)("div",{className:"relative flex flex-col w-2/5 h-full overflow-auto",children:[(0,n.jsxs)("div",{className:"pt-4 pb-2 relative overflow-visible",children:[(0,n.jsx)(ek,{isThinking:!!(a.searchingStartTime&&!a.searchingEndTime)&&d,startTime:null!=(s=a.searchingStartTime)?s:C,endTime:null!=(i=a.searchingEndTime)?i:T,sourcesCount:S,hasError:"error"===a.state,deepsearchPreset:a.deepsearchPreset}),(0,n.jsx)("div",{className:"absolute left-0 top-[100%] w-full h-5 bg-gradient-to-b z-40 from-surface-base"})]}),(0,n.jsxs)(ey,{children:[I.length>0?(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"relative z-20 flex flex-col px-4 w-full",children:I.map((e,t)=>(0,n.jsx)("div",{"data-scrollid":"menuitem_".concat(e.id),className:(0,c.cn)("w-full pt-3",t===I.length-1?"pb-6":"pb-3"),children:(0,n.jsx)(eN,{isActive:o===e.id,onClick:()=>x(e.id),header:e.header,isComplete:j(e.id)})},e.id))}),(0,n.jsx)("div",{className:"absolute left-[26px] flex items-center justify-center top-0 pt-6 z-10 h-full",children:(0,n.jsx)("div",{className:"w-0.5 bg-border-l2 h-full"})})]}):null,_?(0,n.jsx)("div",{"data-scrollid":"menuitem_".concat(_.id),className:"w-full px-4 pb-6 relative z-40",children:(0,n.jsx)(eN,{isActive:o===_.id,onClick:()=>x(_.id),header:_.header,isComplete:j(_.id)})},_.id):null]}),(0,n.jsxs)("div",{className:"pt-1 pb-3 px-3 relative overflow-visible",children:[(0,n.jsxs)("div",{className:"flex items-center justify-start",children:[(0,n.jsx)(M.gx,{tooltipContent:(0,n.jsx)("span",{children:h("Expand","Expand")}),tooltipContentProps:{side:"bottom"},tooltipProps:{delayDuration:500},variant:"ghostSecondary",size:"iconSm",onClick:p,children:u?(0,n.jsx)(em.A,{size:18}):(0,n.jsx)(ef.A,{size:18})}),f?(0,n.jsx)(M.gx,{tooltipContent:(0,n.jsx)("span",{children:h("Show thinking","Show thinking")}),tooltipContentProps:{side:"bottom"},tooltipProps:{delayDuration:500},variant:"ghostSecondary",size:"iconSm",onClick:v,children:(0,n.jsx)(eg.A,{size:20})}):null]}),(0,n.jsx)("div",{className:"absolute left-0 bottom-[100%] w-full h-5 bg-gradient-to-t z-40 from-surface-base"})]})]})};var eI=s(49942),e_=s(78033);let eC=e=>{var t;let{decision:s,webSearchResults:i}=e,a=(0,P.aP)(b.A("setSidePanelContent")),{t:l}=(0,w.Bd)(["base","chat"]),{client:o}=(0,R.useStatsigClient)(),c=(0,r.useCallback)(()=>{o.logEvent("show_all_research_box_search_results",void 0,{location:"searching-step"}),a({type:"webSearchResults",data:{webSearchResults:i}})},[i]),d=(0,r.useMemo)(()=>i.slice(0,5),[i]);return(0,n.jsxs)("div",{className:"w-full flex flex-col",children:[(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(X.A,{size:12,className:"text-secondary"})}),(0,n.jsx)("span",{children:(0,n.jsx)(w.x6,{ns:"chat",i18nKey:"super-search-searching-for",defaults:'Searching for <bold>"{{query}}"</bold>',values:{query:null==s||null==(t=s.action_input)?void 0:t.query},components:{bold:(0,n.jsx)("strong",{})}})})]})}),(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(e_.A,{size:12,className:"text-secondary"})}),(0,n.jsx)("span",{children:l("webResultsFound",{count:i.length,ns:"base",defaultValue_one:"one result found",defaultValue_other:"{{count}} results found"})})]})}),(0,n.jsx)("div",{className:"relative w-full h-full pl-12 pr-4 mb-2 mt-3",children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("div",{className:"flex flex-col gap-3",children:d.map((e,t)=>(0,n.jsx)("div",{className:"w-full max-w-full overflow-hidden relative",children:(0,n.jsxs)("div",{className:"flex max-w-full items-start",children:[e.favicon?(0,n.jsx)("img",{src:e.favicon,alt:"favicon",className:"m-0 mr-3 w-3 h-3"}):null,(0,n.jsx)("div",{className:"max-w-full text-primary text-sm h-4 leading-3 whitespace-nowrap overflow-hidden text-ellipsis",children:(0,n.jsx)("a",{href:e.url,target:"_blank",className:"max-w-full !decoration-transparent hover:!decoration-secondary",children:e.title})}),(0,n.jsx)("div",{className:"ml-1 text-secondary text-xs leading-4 text-nowrap",children:e.url?(0,O.T)(e.url):void 0})]})},t+":"+e.url))}),(0,n.jsx)("div",{className:"w-full relative flex justify-start items-start mt-2",children:(0,n.jsx)("div",{className:"text-secondary text-sm ",children:(0,n.jsx)(M.$n,{onClick:c,variant:"ghost",className:"text-secondary hover:text-primary p-0 h-auto hover:bg-transparent",children:i.length<=d.length?l("See all","See all",{ns:"chat"}):l("See more","See more",{ns:"chat"})+" (".concat(i.length-d.length,")")})})})]})}),(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(eI.A,{size:12,className:"text-secondary"})}),(0,n.jsx)(w.x6,{ns:"base",i18nKey:"Browsing results",children:"Browsing results"})]})})]})},eT=[],eE=e=>{var t,s,i,a,l;let{isStreaming:o,step:d,stepId:u}=e,{t:p}=(0,w.Bd)("chat"),x=(0,P.aP)(b.A("setSidePanelContent")),h=(0,r.useRef)(!1),m=o?N.Cn:N.Ad,f=(()=>{if(!d.tags||!d.text)return null;let e=d.tags.indexOf("decision");if(-1===e)return null;let t=d.text[e];try{return JSON.parse(t)}catch(e){return null}})(),g=(0,r.useRef)(null),v=(()=>{if(!d.tags||!d.text)return null;let e=d.tags.indexOf("summary");return -1===e?null:d.text[e]})();h.current||(g.current=v);let j=(0,r.useCallback)(()=>{var e;d.xposts&&(null==(e=d.xposts)?void 0:e.length)>0&&x({type:"xPosts",data:d.xposts})},[null==(t=d.xposts)?void 0:t.length]);(d.webSearchResults&&d.webSearchResults.length>0||(null==f?void 0:f.action)==="browse_page"||d.xposts&&d.xposts.length>0)&&(h.current=!0);let y=o?{delay:.2,duration:.2,ease:"easeIn"}:{},k=null!=(l=null==(s=g.current)?void 0:s.split("\n").filter(Boolean))?l:[];return(0,n.jsx)(B.N,{children:(0,n.jsxs)("div",{className:(0,c.cn)("flex flex-col gap-1 mt-1","[&_ul]:m-0 marker:text-secondary","[&_a]:text-primary [&_a]:decoration-solid [&_a]:decoration-secondary [&_a]:underline","[&_a:hover]:text-secondary [&_a]:underline-offset-2 [&_a]:font-medium"),children:[k.map((e,t)=>(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:y,children:(0,n.jsx)("div",{className:"overflow-x-auto px-5 leading-6",children:(0,n.jsx)(m,{sender:"assistant",webSearchResults:d.webSearchResults||eT,xposts:d.xposts||eT,isNested:!0,children:e})})},"summary-".concat(u,"-").concat(t))),d.webSearchResults&&d.webSearchResults.length>0&&(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:y,children:(0,n.jsx)(eC,{decision:f,webSearchResults:d.webSearchResults})},"webresults-".concat(u)),(null==f?void 0:f.action)==="browse_page"&&f.action_input.url&&(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:y,children:(0,n.jsx)("div",{className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(eI.A,{size:12,className:"text-secondary"})}),(0,n.jsx)("span",{children:(0,n.jsx)(w.x6,{ns:"chat",i18nKey:"super-search-box-step.browse-page",defaults:'Browsing <site>{{url}}</site> for <bold>"{{query}}"</bold>',values:{url:(0,O.T)(f.action_input.url),query:f.action_input.query},components:{site:(0,n.jsx)("a",{href:f.action_input.url,target:"_blank",rel:"noopener noreferrer"}),bold:(0,n.jsx)("strong",{})}})})]})})},"browse_page-".concat(u)),d.xposts&&d.xposts.length>0?(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:y,children:(0,n.jsxs)("div",{className:"w-full flex flex-col gap-2 pb-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 px-5",children:[(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] text-sm mt-0.5 text-secondary font-bold",children:"\uD835\uDD4F"}),(0,n.jsx)("span",{children:(null==f||null==(i=f.action_input)?void 0:i.query)?(0,n.jsx)(w.x6,{ns:"chat",i18nKey:"super-search-box-step.xposts-with-query",defaults:'Searching on X for <bold>"{{query}}"</bold>',values:{query:null==f||null==(a=f.action_input)?void 0:a.query},components:{bold:(0,n.jsx)("strong",{})}}):p("super-search-box-step.xposts-without-query","Searching on X for")})]}),(0,n.jsx)(M.$n,{variant:"ghostSecondary",size:"sm",className:"rounded-full transition-all mr-0.5",onClick:j,children:p("See all","See all")})]}),(0,n.jsx)("div",{className:"relative w-full h-full",children:(0,n.jsx)("div",{className:"flex gap-3 w-full h-full items-stretch overflow-x-auto pr-4 pb-2 pl-11",children:d.xposts.map((e,t)=>(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)(F,{post:e})},t))})})]})},"xposts-".concat(u)):null]})})},eA=(0,r.forwardRef)((e,t)=>{let{responseId:s,className:i,groups:a,isStreaming:l=!1}=e;return(0,n.jsx)("div",{className:(0,c.cn)("w-full h-full overflow-hidden relative flex flex-col items-start border-l border-border-l1 bg-surface-l1",i),children:(0,n.jsx)(ey,{ref:t,children:(0,n.jsx)("div",{className:"flex flex-col pb-5 pt-2",children:a.map(e=>(0,n.jsx)(eR,{group:e,responseId:s,isStreaming:l},e.id))})})})}),eR=e=>{let{responseId:t,group:s,isStreaming:i}=e;return(0,n.jsx)(B.N,{children:(0,n.jsxs)("div",{"data-scrollid":s.id,children:[(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:i?{delay:.2,duration:.2,ease:"easeIn"}:{},children:(0,n.jsx)("div",{className:"text-md text-primary font-medium px-6 pt-5",children:s.header})},"title-".concat(s.id)),s.steps.map((e,a)=>(0,n.jsx)("div",{id:"".concat(t,"_section_").concat(a),children:(0,n.jsx)(eE,{stepId:"step_".concat(s.id,"_").concat(a),step:e,isStreaming:i},"step_".concat(a))},"".concat(t,"_section_").concat(a)))]})})};function eP(e){var t;let{response:s,isStreaming:i}=e,{t:a}=(0,w.Bd)("chat"),{client:l}=(0,R.useStatsigClient)(),[o,d]=(0,r.useState)(!1),u=(0,r.useRef)(null),[p,x]=(0,r.useState)(),h=(()=>{if(!s.steps)return[];let e=[];return s.steps.forEach((t,n)=>{var i,l,r,o;let c=t.tags.indexOf("header")>-1;if(!c&&0===n)return void e.push({id:A({header:a("deepsearch-thinking","Thinking"),responseId:null!=(i=s.responseId)?i:"",index:n}),header:a("deepsearch-thinking","Thinking"),steps:[t]});if(c){let i=(null==(r=t.text)?void 0:r[(null==(l=t.tags)?void 0:l.indexOf("header"))||0])||"";e.push({id:A({header:i,responseId:null!=(o=s.responseId)?o:"",index:n}),header:i,steps:[t]});return}e[e.length-1].steps.push(t)}),e})(),m=(0,r.useCallback)(e=>{var t,n;u.current&&(l.logEvent("scroll_to_research_box_section",e,{location:"research-box",responseId:null!=(t=s.responseId)?t:"",conversationId:null!=(n=s.conversationId)?n:""}),u.current.scrollToId(e),x(e))},[l,s.responseId,s.conversationId]),f=(0,r.useCallback)(()=>{var e,t;let n=!o;l.logEvent("toggle_research_box_wide",n?"wide":"narrow",{location:"research-box",responseId:null!=(e=s.responseId)?e:"",conversationId:null!=(t=s.conversationId)?t:""}),d(n)},[l,o,s.responseId,s.conversationId]),g=(0,r.useMemo)(()=>h[h.length-1],[h]),v=null!=p?p:null==g?void 0:g.id;return((0,r.useLayoutEffect)(()=>{u.current&&u.current.setScrollToIdHandler(e=>{x(e)})},[null==g?void 0:g.id]),(0,r.useLayoutEffect)(()=>{let e=document.querySelector("div[data-scrollid=menuitem_".concat(p,"]"));e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})},[p]),s.hasImages||(!s.searchingStartTime||["closed","error"].includes(null!=(t=s.state)?t:""))&&(!s.steps||0===s.steps.length))?null:(0,n.jsx)("div",{className:(0,c.cn)("relative border border-border-l1 bg-surface-base rounded-2xl overflow-clip h-[500px] transition-[height_1000ms,width_1000ms] mb-4",o?"@[1600px]/mainview:-mx-32 @6xl/mainview:-mx-12 @lg/mainview:-mx-32 @md/mainview:-mx-4 h-[70vh]":"@md/mainview:-mx-4  h-[500px]"),children:(0,n.jsxs)("div",{className:"absolute text-secondary w-full h-full overflow-y-clip flex",children:[(0,n.jsx)(eS,{groups:h,isStreaming:i,isWide:o,visibleLastStep:v,response:s,scrollToSection:m,toggleWide:f}),(0,n.jsx)("div",{className:"gap-3 relative min-h-full w-full h-full",children:(0,n.jsx)("div",{className:"absolute w-full transition-colors overflow-hidden group/trace h-full",children:(0,n.jsx)(eA,{ref:u,responseId:s.responseId,groups:h,showMask:!1,className:"",isStreaming:i,linesCount:20})})})]})})}let ez=(0,r.forwardRef)((e,t)=>{let{children:s,onAutoscrollUpdate:i}=e,a=(0,r.useRef)(null),[l,o]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1),[p,x]=(0,r.useState)(!0),h=(0,r.useRef)(()=>{}),m=(0,j.C)(e=>e.userSettings.preferences.disableAutoScroll),f=(0,r.useCallback)(e=>{a.current&&(u(!1),a.current.scrollTo({top:a.current.scrollHeight,behavior:e}))},[]),g=(0,r.useCallback)(e=>{if(!e)return;let t=document.querySelector('div[data-scrollid="'.concat(e,'"]'));if(!t||!a.current)return;let{top:s}=eM(t,a.current);a.current.scrollTo({top:s,behavior:"smooth"}),o(!1)},[]),v=(0,r.useCallback)(e=>{h.current=e},[]);(0,r.useEffect)(()=>{f("instant")},[]),(0,r.useEffect)(()=>{null==i||i(l)},[i,l]),(0,r.useImperativeHandle)(t,()=>{var e,t,s;return{scrollToId:g,setScrollToIdHandler:v,el:a.current,scrollHeight:null==(e=a.current)?void 0:e.scrollHeight,scrollTop:null==(t=a.current)?void 0:t.scrollTop,clientHeight:null==(s=a.current)?void 0:s.clientHeight}}),(0,r.useEffect)(()=>{if(!a.current)return;let e=new MutationObserver(()=>{if(!a.current)return void u(!1);let e=a.current.scrollHeight-a.current.scrollTop-a.current.clientHeight,t=e<5;if(t!==p&&x(t),u(!l&&e>15),l&&!t&&!m){f("smooth");let e=a.current.querySelectorAll("div[data-scrollid]"),t=e[e.length-1];if(t){var s;let e=null!=(s=t.getAttribute("data-scrollid"))?s:void 0;e&&h.current(e)}}});return e.observe(a.current,{childList:!0,subtree:!0}),()=>{e.disconnect()}},[p,l,m]);let y=(0,r.useCallback)(()=>{o(!1)},[]),b=(0,r.useCallback)(()=>{if(a.current){let e=function(e){return e.scrollHeight<e.scrollTop+e.clientHeight+5}(a.current);e!==p&&x(e),u(!e)}},[p]),w=(0,r.useCallback)(e=>{if(e.deltaY>0&&a.current&&!l){let e=a.current.scrollTop;e+a.current.clientHeight+50>=a.current.scrollHeight&&!m&&o(!0)}if(e.deltaY<0&&l&&y(),!a.current)return;let t=a.current.querySelectorAll("div[data-scrollid]");if(t.length>0){let e,n=a.current.scrollTop,i=a.current.clientHeight,l=a.current.scrollHeight,r=1/0;if(n<20)e=t[0];else if(n+i>=l-20)e=t[t.length-1];else{let s=n+i/2;for(let n of t){let{top:t}=eM(n,a.current);if(s>t&&s<t+n.clientHeight){e=n;break}let i=Math.abs(s-(t+n.clientHeight/2));i<r&&(e=n,r=i)}}if(e){var s;let t=null!=(s=e.getAttribute("data-scrollid"))?s:void 0;h.current(t)}else h.current(void 0)}},[l,m]);return(0,n.jsxs)("div",{ref:a,className:(0,c.cn)("w-full h-full overflow-y-auto overflow-x-hidden scrollbar-gutter-stable no-scrollbar"),onScroll:b,onTouchStart:y,onWheel:w,onDragStart:y,onPointerDown:y,onResize:y,children:[s,d?(0,n.jsx)("div",{className:"absolute flex justify-center w-full h-0 pr-4 mx-auto -top-3",children:(0,n.jsx)("div",{className:(0,c.cn)("h-0 flex items-end justify-end w-full",ev.Q,"px-2 z-40"),children:(0,n.jsx)(M.$n,{onClick:()=>o(!0),variant:"outline",size:"icon",className:"rounded-full bg-input backdrop-blur-sm size-8",children:(0,n.jsx)(ej.A,{size:20,className:"-mb-0.5"})})})}):null]})});function eM(e,t){let s=e.getBoundingClientRect(),n=t.getBoundingClientRect();return{top:s.top-n.top+t.scrollTop,left:s.left-n.left+t.scrollLeft}}let eO=e=>{let{header:t,isActive:s,isComplete:i,onClick:a}=e;return(0,n.jsxs)("div",{className:(0,c.cn)("flex items-start gap-2 group/header",s?void 0:"cursor-pointer"),onClick:a,children:[(0,n.jsx)(B.N,{children:i?(0,n.jsx)(U.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex items-center bg-surface-base",children:(0,n.jsx)(ew.pry,{className:(0,c.cn)("text-primary size-[22px] flex-shrink-0",s?void 0:"opacity-60 group-hover/header:opacity-100")})},"check"):(0,n.jsx)(U.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},className:"flex-shrink-0 flex items-center bg-background relative z-30",children:(0,n.jsx)(K.y,{size:"sm"})},"spinner")}),(0,n.jsx)("div",{className:"flex items-center text-white",children:(0,n.jsx)("div",{className:(0,c.cn)("text-md text-primary font-medium max-w-full leading-6",s?void 0:"opacity-60 group-hover/header:opacity-100"),children:i?t:(0,n.jsx)(U.P.div,{style:{backgroundSize:"200% 100%"},animate:{backgroundPosition:["100% 0%","-100% 0%"]},transition:{duration:1,ease:"linear",repeat:Number.POSITIVE_INFINITY},children:t})})})]})},eD=e=>{var t;let{response:s,groups:i,visibleLastStep:a,isStreaming:l,isWide:o,toggleWide:d,scrollToSection:u}=e,{t:p}=(0,w.Bd)("chat"),x=(0,P.aP)(b.A("setSidePanelContent")),h=null==(t=s.steps)?void 0:t.some(e=>{var t;return null==(t=e.tags)?void 0:t.includes("assistant")}),{client:m}=(0,R.useStatsigClient)(),f=(0,r.useCallback)(()=>(m.logEvent("deep_search_trace_click",s.responseId,{location:"super-search-box"}),s.responseId&&x({type:"thinkingTrace",data:{responseId:s.responseId}}),null),[s.responseId]),g=e=>e!==i[i.length-1].id||!!s.searchingEndTime||!l,v=(0,r.useMemo)(()=>i.slice(void 0,-1),[i]),j=(0,r.useMemo)(()=>i[i.length-1],[i]);return(0,n.jsxs)("div",{className:"relative flex flex-col w-2/5 h-full overflow-auto",children:[(0,n.jsx)("div",{className:"absolute left-0 top-0 w-full h-5 bg-gradient-to-b z-40 from-surface-base"}),(0,n.jsx)(ez,{children:(0,n.jsxs)("div",{className:"pt-2",children:[v.length>0?(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"relative z-20 flex flex-col px-4 w-full",children:v.map((e,t)=>(0,n.jsx)("div",{"data-scrollid":"menuitem_".concat(e.id),className:(0,c.cn)("w-full pt-3",t===v.length-1?"pb-6":"pb-3"),children:(0,n.jsx)(eO,{isActive:a===e.id,onClick:()=>u(e.id),header:e.header,isComplete:g(e.id)})},e.id))}),(0,n.jsx)("div",{className:"absolute left-[26px] flex items-center justify-center top-0 pt-6 z-10 h-full",children:(0,n.jsx)("div",{className:"w-0.5 bg-border-l2 h-full"})})]}):null,j?(0,n.jsx)("div",{"data-scrollid":"menuitem_".concat(j.id),className:"w-full px-4 pb-6 relative z-40",children:(0,n.jsx)(eO,{isActive:a===j.id,onClick:()=>u(j.id),header:j.header,isComplete:g(j.id)})},j.id):null]})}),(0,n.jsxs)("div",{className:"pt-1 pb-3 px-3 relative overflow-visible",children:[(0,n.jsxs)("div",{className:"flex items-center justify-start",children:[(0,n.jsx)(M.gx,{tooltipContent:(0,n.jsx)("span",{children:p("Expand","Expand")}),tooltipContentProps:{side:"bottom"},tooltipProps:{delayDuration:500},variant:"ghostSecondary",size:"iconSm",onClick:d,children:o?(0,n.jsx)(em.A,{size:18}):(0,n.jsx)(ef.A,{size:18})}),h?(0,n.jsx)(M.gx,{tooltipContent:(0,n.jsx)("span",{children:p("Show thinking","Show thinking")}),tooltipContentProps:{side:"bottom"},tooltipProps:{delayDuration:500},variant:"ghostSecondary",size:"iconSm",onClick:f,children:(0,n.jsx)(eg.A,{size:20})}):null]}),(0,n.jsx)("div",{className:"absolute left-0 bottom-[100%] w-full h-5 bg-gradient-to-t z-40 from-surface-base"})]})]})};function eB(e){let{text:t,duration:s=30,delay:i=500,className:a,endElement:l}=e,[o,d]=(0,r.useState)("");return(0,r.useEffect)(()=>{let e,n=o,a=i=>{t.startsWith(n)?(n=t.substring(0,i),e=setTimeout(()=>a(i+1),s)):(n=n.substring(0,n.length-1),e=setTimeout(()=>a(i),s)),d(n)};return e=setTimeout(()=>a(1),i),()=>clearTimeout(e)},[t,s,i]),(0,n.jsxs)("div",{className:(0,c.cn)("flex flex-row gap-0.5 items-center",a),children:[(0,n.jsx)("span",{className:a,children:o}),t===o?l:void 0]})}let eU=e=>{let{isThinking:t,startTime:s,endTime:i,isStreaming:a,isMinimized:l,onToggle:o}=e,{t:d}=(0,w.Bd)("chat"),u=(0,f.W)(),[p,x]=(0,r.useState)(void 0);(0,r.useEffect)(()=>{if(!s)return;if(!t){s&&i&&x((i-s)/1e3);return}if(i)return void x((i-s)/1e3);let e=setInterval(()=>{x(((i||Date.now())-s)/1e3)},1e3);return()=>clearInterval(e)},[s,i,t]);let m=t?d("Thinking"):p?"".concat(d("Thought for")," ").concat(d("generationTime","{{duration}}s",{duration:p.toFixed(0)})):d(s?"Thinking Completed":"Thoughts"),g=(0,r.useMemo)(()=>(0,n.jsx)(U.P.div,{variants:{hidden:{opacity:0,scale:.5},visible:{opacity:1,scale:1}},transition:{duration:.2*!!a,ease:"easeIn"},initial:"hidden",animate:"visible",exit:"hidden",children:(0,n.jsx)(ej.A,{size:18,className:(0,c.cn)("transition-transform text-secondary",l?void 0:"-rotate-180")})},"follow-ups"),[l,a]);return(0,n.jsx)("div",{className:"flex flex-col w-fit items-start cursor-pointer gap-0 mb-2 text-base space-x-1 transition-padding z-30 duration-200 focus:outline-none focus-within:outline-none transition-none",onClick:o,children:(0,n.jsx)("div",{className:(0,c.cn)("flex h-full gap-1 items-center justify-start text-primary",u?void 0:"px-4"),children:(0,n.jsxs)("div",{className:(0,c.cn)("flex items-center gap-1 overflow-hidden -ml-0.5 transition-colors text-secondary"),children:[(0,n.jsx)("div",{className:"flex",children:t?(0,n.jsx)(h.d,{}):(0,n.jsx)(Y.xm,{size:18})}),(0,n.jsx)("span",{className:(0,c.cn)("text-nowrap font-medium whitespace-nowrap select-none"),children:t?(0,n.jsx)(eB,{text:m,duration:15,endElement:g}):m}),t?void 0:g]})})})},eq=e=>{var t;let{decision:s,webSearchResults:i}=e,a=(0,P.aP)(b.A("setSidePanelContent")),{t:l}=(0,w.Bd)(["base","chat"]),{client:o}=(0,R.useStatsigClient)(),c=(0,r.useCallback)(()=>{o.logEvent("show_all_research_box_search_results",void 0,{location:"searching-step"}),a({type:"webSearchResults",data:{webSearchResults:i}})},[i]),d=(0,r.useMemo)(()=>i.slice(0,5),[i]);return(0,n.jsxs)("div",{className:"w-full flex flex-col",children:[(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(X.A,{size:12,className:"text-secondary"})}),(0,n.jsx)("span",{children:(0,n.jsx)(w.x6,{ns:"chat",i18nKey:"super-search-searching-for",defaults:'Searching for <bold>"{{query}}"</bold>',values:{query:null==s||null==(t=s.action_input)?void 0:t.query},components:{bold:(0,n.jsx)("strong",{})}})})]})}),(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(e_.A,{size:12,className:"text-secondary"})}),(0,n.jsx)("span",{children:l("webResultsFound",{count:i.length,ns:"base",defaultValue_one:"one result found",defaultValue_other:"{{count}} results found"})})]})}),(0,n.jsx)("div",{className:"relative w-full h-full pl-12 pr-4 mb-2 mt-3",children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("div",{className:"flex flex-col gap-3",children:d.map((e,t)=>(0,n.jsx)("div",{className:"w-full max-w-full overflow-hidden relative",children:(0,n.jsxs)("div",{className:"flex max-w-full items-start",children:[e.favicon?(0,n.jsx)("img",{src:e.favicon,alt:"favicon",className:"m-0 mr-3 w-3 h-3"}):null,(0,n.jsx)("div",{className:"max-w-full text-primary text-sm h-4 leading-3 whitespace-nowrap overflow-hidden text-ellipsis",children:(0,n.jsx)("a",{href:e.url,target:"_blank",className:"max-w-full !decoration-transparent hover:!decoration-secondary",children:e.title})}),(0,n.jsx)("div",{className:"ml-1 text-secondary text-xs leading-4 text-nowrap",children:e.url?(0,O.T)(e.url):void 0})]})},t+":"+e.url))}),(0,n.jsx)("div",{className:"w-full relative flex justify-start items-start mt-2",children:(0,n.jsx)("div",{className:"text-secondary text-sm ",children:(0,n.jsx)(M.$n,{onClick:c,variant:"ghost",className:"text-secondary hover:text-primary p-0 h-auto hover:bg-transparent",children:i.length<=d.length?l("See all","See all",{ns:"chat"}):l("See more","See more",{ns:"chat"})+" (".concat(i.length-d.length,")")})})})]})}),(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeIn"},className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(eI.A,{size:12,className:"text-secondary"})}),(0,n.jsx)(w.x6,{ns:"base",i18nKey:"Browsing results",children:"Browsing results"})]})})]})},eH=[],eF=e=>{var t,s,i,a,l;let{isStreaming:o,step:d,stepId:u}=e,{t:p}=(0,w.Bd)("chat"),x=(0,P.aP)(b.A("setSidePanelContent")),h=(0,r.useRef)(!1),m=o?N.Cn:N.Ad,f=(()=>{if(!d.tags||!d.text)return null;let e=d.tags.indexOf("decision");if(-1===e)return null;let t=d.text[e];try{return JSON.parse(t)}catch(e){return null}})(),g=(0,r.useRef)(null),v=(()=>{if(!d.tags||!d.text)return null;let e=d.tags.indexOf("summary");return -1===e?null:d.text[e]})();h.current||(g.current=v);let j=(0,r.useCallback)(()=>{var e;d.xposts&&(null==(e=d.xposts)?void 0:e.length)>0&&x({type:"xPosts",data:d.xposts})},[null==(t=d.xposts)?void 0:t.length]);(d.webSearchResults&&d.webSearchResults.length>0||(null==f?void 0:f.action)==="browse_page"||d.xposts&&d.xposts.length>0)&&(h.current=!0);let y=o?{delay:.2,duration:.2,ease:"easeIn"}:{},k=null!=(l=null==(s=g.current)?void 0:s.split("\n").filter(Boolean))?l:[];return(0,n.jsx)(B.N,{children:(0,n.jsxs)("div",{className:(0,c.cn)("flex flex-col gap-1 mt-1","[&_ul]:m-0 marker:text-secondary","[&_a]:text-primary [&_a]:decoration-solid [&_a]:decoration-secondary [&_a]:underline","[&_a:hover]:text-secondary [&_a]:underline-offset-2 [&_a]:font-medium"),children:[k.map((e,t)=>(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:y,children:(0,n.jsx)("div",{className:"overflow-x-auto px-5 leading-6",children:(0,n.jsx)(m,{sender:"assistant",webSearchResults:d.webSearchResults||eH,xposts:d.xposts||eH,isNested:!0,children:e})})},"summary-".concat(u,"-").concat(t))),d.webSearchResults&&d.webSearchResults.length>0&&(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:y,children:(0,n.jsx)(eq,{decision:f,webSearchResults:d.webSearchResults})},"webresults-".concat(u)),(null==f?void 0:f.action)==="browse_page"&&f.action_input.url&&(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:y,children:(0,n.jsx)("div",{className:"flex items-center gap-3 px-5",children:(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] mt-2",children:(0,n.jsx)(eI.A,{size:12,className:"text-secondary"})}),(0,n.jsx)("span",{children:(0,n.jsx)(w.x6,{ns:"chat",i18nKey:"super-search-box-step.browse-page",defaults:'Browsing <site>{{url}}</site> for <bold>"{{query}}"</bold>',values:{url:(0,O.T)(f.action_input.url),query:f.action_input.query},components:{site:(0,n.jsx)("a",{href:f.action_input.url,target:"_blank",rel:"noopener noreferrer"}),bold:(0,n.jsx)("strong",{})}})})]})})},"browse_page-".concat(u)),d.xposts&&d.xposts.length>0?(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:y,children:(0,n.jsxs)("div",{className:"w-full flex flex-col gap-2 pb-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 px-5",children:[(0,n.jsxs)("div",{className:"text-primary flex justify-start items-start",children:[(0,n.jsx)("div",{className:"min-w-[26px] text-sm mt-0.5 text-secondary font-bold",children:"\uD835\uDD4F"}),(0,n.jsx)("span",{children:(null==f||null==(i=f.action_input)?void 0:i.query)?(0,n.jsx)(w.x6,{ns:"chat",i18nKey:"super-search-box-step.xposts-with-query",defaults:'Searching on X for <bold>"{{query}}"</bold>',values:{query:null==f||null==(a=f.action_input)?void 0:a.query},components:{bold:(0,n.jsx)("strong",{})}}):p("super-search-box-step.xposts-without-query","Searching on X for")})]}),(0,n.jsx)(M.$n,{variant:"ghostSecondary",size:"sm",className:"rounded-full transition-all mr-0.5",onClick:j,children:p("See all","See all")})]}),(0,n.jsx)("div",{className:"relative w-full h-full",children:(0,n.jsx)("div",{className:"flex gap-3 w-full h-full items-stretch overflow-x-auto pr-4 pb-2 pl-11",children:d.xposts.map((e,t)=>(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)(F,{post:e})},t))})})]})},"xposts-".concat(u)):null]})})},eL=(0,r.forwardRef)((e,t)=>{let{responseId:s,className:i,groups:a,isStreaming:l=!1,onAutoscrollUpdate:r}=e;return(0,n.jsx)("div",{className:(0,c.cn)("w-full h-full overflow-hidden relative flex flex-col items-start border-l border-border-l1 bg-surface-l1",i),children:(0,n.jsx)(ez,{ref:t,onAutoscrollUpdate:r,children:(0,n.jsx)("div",{className:"flex flex-col pb-5 pt-2",children:a.map(e=>(0,n.jsx)(eW,{group:e,responseId:s,isStreaming:l},e.id))})})})}),eW=e=>{let{responseId:t,group:s,isStreaming:i}=e;return(0,n.jsx)(B.N,{children:(0,n.jsxs)("div",{"data-scrollid":s.id,children:[(0,n.jsx)(U.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:i?{delay:.2,duration:.2,ease:"easeIn"}:{},children:(0,n.jsx)("div",{className:"text-md text-primary font-medium px-6 pt-5",children:s.header})},"title-".concat(s.id)),s.steps.map((e,a)=>(0,n.jsx)("div",{id:"".concat(t,"_section_").concat(a),children:(0,n.jsx)(eF,{stepId:"step_".concat(s.id,"_").concat(a),step:e,isStreaming:i},"step_".concat(a))},"".concat(t,"_section_").concat(a)))]})})};function eK(e){let{thinkingTrace:t="",className:s,isStreaming:i,onAutoscrollUpdate:a}=e,l=t.split("\n").filter(Boolean),r=i?N.Cn:N.Ad,o=i&&l.length>2?l.slice(0,-1):l;return(0,n.jsx)("div",{className:(0,c.cn)("w-full relative flex flex-col items-start","h-full bg-surface-l1",s),children:(0,n.jsx)(ez,{onAutoscrollUpdate:a,children:(0,n.jsx)("div",{className:(0,c.cn)("w-full pb-2 relative px-4 "),children:o.map((e,t)=>(0,n.jsx)(U.P.div,{variants:{hidden:{opacity:0},visible:{opacity:1}},transition:{duration:1,ease:"easeInOut"},initial:"hidden",animate:"visible",exit:"hidden",children:(0,n.jsx)(r,{sender:"",xposts:[],webSearchResults:[],children:e},t)},"line_".concat(t)))})})})}function eV(e){var t,s,i,a,l,o;let{response:d,isStreaming:u}=e,{t:p}=(0,w.Bd)("chat"),{client:x}=(0,R.useStatsigClient)(),[h,m]=(0,r.useState)(!1),g=(0,r.useRef)(null),[v,j]=(0,r.useState)(),[y,b]=(0,r.useState)(!1),N=(0,f.W)(),k=!!(d.liveThinkingStartTime&&!d.liveThinkingEndTime||d.searchingStartTime&&!d.searchingEndTime)&&u,S=(()=>{if(!d.steps)return[];let e=[];return d.steps.forEach((t,s)=>{var n,i,a,l;let r=t.tags.indexOf("header")>-1;if(!r&&0===s)return void e.push({id:A({header:p("deepsearch-thinking","Thinking"),responseId:null!=(n=d.responseId)?n:"",index:s}),header:p("deepsearch-thinking","Thinking"),steps:[t]});if(r){let n=(null==(a=t.text)?void 0:a[(null==(i=t.tags)?void 0:i.indexOf("header"))||0])||"";e.push({id:A({header:n,responseId:null!=(l=d.responseId)?l:"",index:s}),header:n,steps:[t]});return}e[e.length-1].steps.push(t)}),e})(),I=!k,_=d.thinkingTrace||(null!=(t=d.steps)?t:[]).map(e=>e.text.join("")).join("");!u||k||d.message||(I=!0),_&&_.length<1500&&(I=!0),d.thinkingTrace||S&&!(S.length<2)||(I=!0);let[C,T]=(0,r.useState)(I),[E,P]=(0,r.useState)(I);(0,r.useEffect)(()=>{T(I&&!y)},[I]),(0,r.useEffect)(()=>{if(C)return clearTimeout(setTimeout(()=>{P(!0)},1e3));P(!1)},[C]);let z=(0,r.useCallback)(e=>{var t,s;g.current&&(x.logEvent("scroll_to_research_box_section",e,{location:"research-box",responseId:null!=(t=d.responseId)?t:"",conversationId:null!=(s=d.conversationId)?s:""}),g.current.scrollToId(e),j(e))},[x,d.responseId,d.conversationId]),M=(0,r.useCallback)(()=>{var e,t;let s=!h;x.logEvent("toggle_research_box_wide",s?"wide":"narrow",{location:"research-box",responseId:null!=(e=d.responseId)?e:"",conversationId:null!=(t=d.conversationId)?t:""}),m(s)},[x,h,d.responseId,d.conversationId]),O=(0,r.useMemo)(()=>S[S.length-1],[S]),D=null!=v?v:null==O?void 0:O.id;(0,r.useLayoutEffect)(()=>{g.current&&g.current.setScrollToIdHandler(e=>{j(e)})},[null==O?void 0:O.id]),(0,r.useLayoutEffect)(()=>{let e=document.querySelector("div[data-scrollid=menuitem_".concat(v,"]"));e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})},[v]);let B=(0,r.useCallback)(()=>{b(!0),T(!C)},[C]),U=(0,r.useCallback)(e=>{b(y||!e)},[y,b]),q=d.thinkingStartTime?new Date(d.thinkingStartTime).getTime():void 0,H=d.thinkingEndTime?new Date(d.thinkingEndTime).getTime():void 0;return d.hasImages||(!d.searchingStartTime||["closed","error"].includes(null!=(s=d.state)?s:""))&&(!d.steps||0===d.steps.length)&&!d.liveThinkingStartTime&&!d.thinkingTrace?null:(0,n.jsxs)("div",{className:(0,c.cn)("mb-2",h?"@[1600px]/mainview:-mx-32 @6xl/mainview:-mx-12 @lg/mainview:-mx-32 @md/mainview:-mx-4":"@md/mainview:-mx-4"),children:[(0,n.jsx)(eU,{isThinking:k,startTime:null!=(a=null!=(i=d.searchingStartTime)?i:d.liveThinkingStartTime)?a:q,endTime:null!=(o=null!=(l=d.searchingEndTime)?l:d.liveThinkingEndTime)?o:H,sourcesCount:13,isStreaming:u,hasError:"error"===d.state,deepsearchPreset:d.deepsearchPreset,isMinimized:C,onToggle:B}),E?null:(0,n.jsx)("div",{className:(0,c.cn)("relative border border-border-l1 bg-surface-base rounded-2xl overflow-hidden transition-[height_1000ms,width_1000ms,opacity_1000ms]",h?"h-[70vh]":"h-[500px]",C?"h-[0px] opacity-0":"mt-2 mb-6"),children:(0,n.jsxs)("div",{className:"absolute text-secondary w-full overflow-y-clip flex h-full",children:[N?null:(0,n.jsx)(eD,{groups:S,isStreaming:u,isWide:h,visibleLastStep:D,response:d,scrollToSection:z,toggleWide:M}),(0,n.jsx)("div",{className:"gap-3 relative min-h-full w-full h-full",children:(0,n.jsx)("div",{className:"absolute w-full transition-colors overflow-hidden group/trace h-full",children:d.thinkingTrace&&!(S&&S.length)?(0,n.jsx)(eK,{thinkingTrace:d.thinkingTrace,isStreaming:u,onAutoscrollUpdate:U}):(0,n.jsx)(eL,{ref:g,responseId:d.responseId,groups:S,showMask:!1,className:"",isStreaming:u,linesCount:20,onAutoscrollUpdate:U})})})]})})]})}let e$=[];function eY(e){var t,s,a,l,o;let{response:c,isStreaming:d,showMarkdown:k,readOnly:S,isModerated:I=!1}=e,_=(0,m.h)(),{t:C}=(0,w.Bd)("chat"),T=(0,f.W)(),E="human"===c.sender,A=(0,j.C)(e=>e.userSettings.preferences.displayUserMessageMarkdown),R=(0,g.sf)(b.A("inlineSettings")),P=(0,r.useMemo)(()=>Object.keys(R),[R]),{sender:M,message:O,cardAttachmentsJson:D,hasSearches:B,conversationId:U,responseId:q,progressReport:H}=c,F=function e(t){var s;let{message:n,isFromUser:i,isStreaming:a,createTime:l,conversationId:r,responseId:o}=t;if(!n)return[{type:"text",body:""}];if(i)return[{type:"text",body:n}];let c=[],d=/<xaiArtifact.*([^\/]>|$)/g.exec(n),u=null!=(s=null==d?void 0:d.index)?s:-1,p=n.slice(u);if(u>0&&c.push({type:"text",body:n.slice(0,u)}),-1!==u&&function(e){if(0===e.length||"<"!==e[0])return!1;let t="xaiArtifact";return t.startsWith(e.substring(1).slice(0,t.length))}(p)){let t=p.indexOf(">"),s=p.indexOf("</xaiArtifact>");if(r&&o&&-1===t)return c.push({type:"artifact",conversationId:r,responseId:o,incomplete:-1===s,timestamp:l?(0,y.W)(l):void 0}),c;{let{title:t,language:n,id:d,contentType:u,versionId:x,content:h}=(0,ex.t)(p);if(r&&o&&-1===s)return c.push({id:null!=d?d:void 0,versionId:x,type:"artifact",conversationId:r,responseId:o,incomplete:-1===s,contentType:null!=u?u:void 0,title:null!=t?t:void 0,content:h,language:null!=n?n:void 0,timestamp:l?(0,y.W)(l):void 0}),c;{let[,...m]=p.split("</xaiArtifact>"),f=m.join("</xaiArtifact>");return(r&&o&&c.push({type:"artifact",id:null!=d?d:void 0,versionId:x,incomplete:-1===s,conversationId:r,responseId:o,content:h,contentType:null!=u?u:void 0,title:null!=t?t:void 0,language:null!=n?n:void 0,timestamp:l?(0,y.W)(l):void 0}),f)?[...c,...e({message:f,isFromUser:i,isStreaming:a,createTime:l,conversationId:r,responseId:o})]:c}}}return[{type:"text",body:n}]}({message:null!=O?O:"",isFromUser:E,isStreaming:d,createTime:c.createTime,responseId:null!=(l=c.inflightResponseId)?l:q,conversationId:U});(0,r.useEffect)(()=>{let e=g.D4.getState().upsertArtifact;F.forEach(t=>{"artifact"===t.type&&e(t,null!=U?U:"")})},[F]);let L=d?N.Cn:N.Ad,W="optimistic"===c.state,K=(0,r.useMemo)(()=>{var e,t,s;return"closed"!==c.state&&"error"!==c.state&&!!c.state&&(null==(e=c.thinkingTrace)||!e.length)&&(null==(t=c.message)||!t.length)&&(null==(s=c.steps)||!s.length)&&!c.hasImages},[c.message,c.hasImages,c.state,c.thinkingTrace,null==(t=c.steps)?void 0:t.length]),V=(0,r.useMemo)(()=>(0,v.Ko)(c),[c.liveThinkingStartTime,c.searchingStartTime]),$=!E||(null!=k?k:A),Y=(null==(s=c.generatedImageUrls)?void 0:s.length)||Object.keys(null!=(o=c.streamingImageById)?o:{}).length,G=!E&&!!Y,{uniqueXPosts:J,uniqueWebSearchResults:X,uniqueBrowsedUrls:Z}=z(c),Q=(0,r.useMemo)(()=>(null==H?void 0:H.state)==="PROGRESS_REPORT_STATUS_PENDING"&&(null==H?void 0:H.category)?H.category:B?"SEARCHING":void 0,[B,H]),[et,en]=(0,r.useState)([]),ei=(null==(a=c.uiLayout)?void 0:a.reasoningUiLayout)==="UNIFIED",ea=(0,r.useMemo)(()=>et.filter(e=>"youtube"===e.type),[et]),el=(0,r.useMemo)(()=>et.filter(e=>"reddit"===e.type),[et]);return(0,n.jsxs)(n.Fragment,{children:[ei?(0,n.jsx)(eV,{response:c,isStreaming:d},c.responseId):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(es,{response:c,isStreaming:d}),T?(0,n.jsx)(ee,{response:c,isStreaming:d},c.responseId):(0,n.jsx)(eP,{response:c,isStreaming:d},c.responseId)]}),K&&!V&&(0,n.jsx)("div",{className:"flex flex-row gap-1 mb-1 text-xl",children:(0,n.jsx)(h.d,{state:Q})}),(0,n.jsx)(i.S,{cardAttachmentJsons:D}),(0,n.jsx)(eh.m,{response:c,isStreaming:d,numImages:d?c.imageAttachmentCount||v.Jg:Y||0,readOnly:S}),F.map((e,t)=>{if(G)return null;if("artifact"===e.type){let s={...e};return s.id&&P.includes(s.id)&&(s.isInline=!0),(0,n.jsx)("div",{className:"py-1",children:(0,n.jsx)(eu,{artifact:s,isStreaming:d,readOnly:null!=S&&S})},t)}if($){var s;return(0,n.jsx)("div",{className:"[&_a]:text-current [&_a:hover]:text-primary [&_a:hover]:decoration-primary [&_a]:underline [&_a]:decoration-primary/30 [&_a]:underline-offset-2",children:(0,n.jsx)(L,{sender:M||"",webSearchResults:X||e$,xposts:J||e$,hideCitations:!!(null==(s=c.steps)?void 0:s.length),setExtractedMedia:en,children:e.body})},t)}return(0,n.jsx)("span",{className:"whitespace-pre-wrap",children:null==e?void 0:e.body},t)}),!d&&J.length>0&&_.SHOW_X_INLINE&&(0,n.jsx)("div",{className:"flex flex-col @md/mainview:flex-row gap-2 mt-3 @md/mainview:-mx-4",children:J.slice(0,3).map((e,t)=>(0,n.jsx)(x.N3,{className:"bg-surface-l1 border border-border-l1 hover:bg-surface-l4-hover dark:hover:bg-surface-l2 not-prose",xPost:e},t))}),!d&&ea.length>0&&_.SHOW_YOUTUBE_EMBEDS&&(_.ONLY_USE_SINGLE_YOUTUBE?(0,n.jsx)(u,{cardAttachment:{url:ea[0].url}}):(0,n.jsx)("div",{className:"flex flex-col gap-1 mb-1 justify-around",children:ea.map(e=>(0,n.jsx)(u,{cardAttachment:{url:e.url}},e.url))})),!d&&el.length>0&&_.SHOW_REDDIT_EMBEDS&&(0,n.jsx)(p,{cardAttachments:el.slice(0,3).map(e=>({url:e.url}))}),!d&&!W&&!G&&!K&&!I&&!c.message&&(0,n.jsx)("p",{className:"text-secondary italic",children:C("No response","No response")+"."}),I&&(0,n.jsx)("p",{className:"text-secondary italic",children:C("Content Moderated","Content Moderated. Try a different idea.")}),"reconnecting"===c.state&&(0,n.jsx)("p",{className:"text-secondary italic",children:C("Reconnecting...","Reconnecting...")}),d||W||G||K||I||!(Z.length>0)&&!(J.length>0)&&!(X.length>0)&&(!_.SHOW_SEARCH_DEEPER||!c.followUpSuggestedMode)||E?void 0:(0,n.jsx)("div",{className:"flex gap-2 mt-4",children:(0,n.jsx)(x.LT,{webSearchResults:X,xPosts:J,browsedUrls:Z})})]})}},15840:(e,t,s)=>{s.d(t,{m:()=>eM});var n=s(79342),i=s(67591),a=s(39489),l=s(4878),r=s(60020),o=s(88382),c=s(65146);let d=e=>{let{response:t}=e,{t:s}=(0,c.Bd)("chat"),{ASSET_SERVER_URL:d}=(0,a.v)(),u=t?(0,l.sU)(d,t.imageEditUri):void 0,[p,x]=o.useState(!1),h=(0,o.useMemo)(()=>p?Error(s("Failed to load image","Failed to load image")):void 0,[p,s]);return(0,n.jsxs)("div",{className:"h-auto flex items-center rounded-xl gap-3",children:[(0,n.jsx)(r.A,{className:"text-fg-secondary size-4"}),(0,n.jsx)("figure",{className:"size-10 overflow-hidden rounded-lg flex items-center justify-center",children:p?(0,n.jsx)(i.V,{fileName:"",labelClassName:"-ml-2",metadata:h}):(0,n.jsx)("img",{className:"w-full h-full object-cover",src:u,alt:s("Original image to edit","Original image to edit"),onError:()=>x(!0)})})]})};var u=s(89003),p=s(44428),x=s(82591),h=s(43654),m=s(42423),f=s(37469),g=s(56691),v=s(47127),j=s(43086),y=s(61884),b=s(64820),w=s(75500),N=s(4295),k=s(33473),S=s(24734),I=s(16596),_=s(70526),C=s(17703),T=s(61312),E=s(86822),A=s(23329),R=s(43893),P=s(44347),z=s(20337),M=s(73069),O=s.n(M),D=s(82263),B=s(49315),U=s(22406),q=s(34873),H=s(16506),F=s(39116),L=s(74995),W=s(53915),K=s(46815),V=s(7616),$=s(14908),Y=s(92539),G=s(19728),J=s(10505),X=s(57799),Z=s(30653),Q=s(97141);function ee(e){let{response:t}=e,s=t.message;if(t.metadata&&"artifactAction"in t.metadata){let e=t.metadata.artifactAction;"ask"===e?s=(0,n.jsx)(et,{message:t.message}):"explain"===e&&(s=(0,n.jsx)(es,{}))}return(0,n.jsx)(Q.i,{isUser:!0,children:(0,n.jsx)(Z.s,{isUser:!0,children:s})})}function et(e){let{message:t}=e,{t:s}=(0,c.Bd)("chat");return(0,n.jsxs)("div",{children:[(0,n.jsxs)(en,{children:[(0,n.jsx)(r.A,{size:12}),s("artifact-action.ask","Ask Grok")]}),(0,n.jsx)("div",{children:t})]})}function es(){let{t:e}=(0,c.Bd)("chat");return(0,n.jsxs)(en,{children:[(0,n.jsx)(X.A,{size:12}),e("artifact-action.explain","Explain")]})}function en(e){let{children:t}=e;return(0,n.jsx)("header",{className:"text-secondary text-sm flex items-center gap-1 pt-1",children:t})}var ei=s(63174);function ea(e){let{initialMessage:t,onCancel:s,onSave:i}=e,{t:a}=(0,c.Bd)("chat"),[l,r]=(0,o.useState)(t),d=(0,o.useRef)(null),u=(0,N.c)(),p=(0,o.useCallback)(e=>{r(e.target.value)},[]),x=(0,o.useCallback)(()=>{i(l)},[i,l]),h=(0,o.useCallback)(e=>{let t=!e.metaKey&&!e.ctrlKey&&!e.shiftKey,s=!e.nativeEvent.isComposing&&"Process"!==e.key&&"KeyZ"!==e.code;if("Enter"===e.key&&t&&s&&!u){e.preventDefault(),x();return}},[x,u]),m=(0,o.useCallback)(e=>{let t=e.target.value;e.target.value="",e.target.value=t},[]);return(0,n.jsxs)("div",{className:"flex flex-col w-full gap-2",children:[(0,n.jsx)(ei.A,{dir:"auto",ref:d,autoFocus:!0,className:(0,T.cn)("w-screen max-w-[100%]","bg-transparent","focus:outline-none","text-primary"),placeholder:a("Enter prompt here","Enter prompt here"),style:{resize:"none"},onKeyDown:h,onChange:p,defaultValue:t,onFocus:m}),(0,n.jsxs)("div",{className:"flex flex-row justify-end w-full gap-2 p-1",children:[(0,n.jsx)(g.$n,{variant:"ghost",size:"sm",onClick:s,children:a("Cancel","Cancel")}),(0,n.jsx)(g.$n,{variant:"filled",size:"sm",onClick:x,children:a("Save","Save")})]})]})}var el=s(66587),er=s(73772),eo=s(24658),ec=s(27009),ed=s(97377),eu=s(52871),ep=s(27521),ex=s(40675),eh=s(48290),em=s(5015),ef=s(94870),eg=s(8516),ev=s(85192),ej=s(45385);let ey={icon:(0,n.jsx)(eo.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.positive-feedback.helpful-answer",defaults:"Helpful answer"}),type:"helpful-answer"},eb=[{icon:(0,n.jsx)(ec.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.positive-feedback.well-written-response",defaults:"Well-written response"}),type:"well-written"},{icon:(0,n.jsx)(ed.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.positive-feedback.accurate-info",defaults:"Accurate information"}),type:"accurate-info"},{icon:(0,n.jsx)(eu.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.positive-feedback.funny-response",defaults:"Funny response"}),type:"funny-response"},{icon:(0,n.jsx)(ep.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.positive-feedback.good-use-of-memory",defaults:"Good use of memory"}),type:"good-use-of-memory"}],ew={icon:(0,n.jsx)(ex.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.negative-feedback.wanted-something-else",defaults:"Wanted something else"}),type:"wanted-something-else"},eN=[{icon:(0,n.jsx)(eh.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.negative-feedback.incorrect-answer",defaults:"Incorrect answer"}),type:"incorrect-answer"},{icon:(0,n.jsx)(em.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.negative-feedback.biased-answer",defaults:"Biased answer"}),type:"biased-answer"},{icon:(0,n.jsx)(ef.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.negative-feedback.wanted-image",defaults:"Wanted image"}),type:"wanted-image"},{icon:(0,n.jsx)(eg.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.negative-feedback.bad-style",defaults:"Bad style / tone"}),type:"bad-style"},{icon:(0,n.jsx)(ev.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.negative-feedback.wanted-search",defaults:"Wanted to search"}),type:"wanted-search"},{icon:(0,n.jsx)(ej.A,{height:14,width:14}),label:(0,n.jsx)(c.x6,{ns:"base",i18nKey:"response.negative-feedback.incorrect-memory",defaults:"Incorrect memory"}),type:"incorrect-memory"}];function ek(e){for(let t=e.length-1;t>0;t--){let s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}function eS(e){let{handleClick:t,triggerButton:s,showDropdown:i,options:a,setDropdownIsOpen:l}=e,[r,c]=o.useState(!1);return(0,n.jsxs)(er.rI,{open:r,onOpenChange:e=>{!i&&e&&t();let s=e&&i;c(s),l(s)},children:[(0,n.jsx)(er.ty,{asChild:!0,children:s}),(0,n.jsx)(er.SQ,{side:"bottom",align:"end",sideOffset:6,className:"min-w-36 space-y-0.5",children:a.map(e=>(0,n.jsxs)(er._2,{onClick:()=>{t(e.type)},className:(0,T.cn)("flex items-center gap-2"),children:[e.icon,e.label]},e.type))})]})}var eI=s(93436),e_=function(e){return e[e.REPORT=0]="REPORT",e}(e_||{});let eC=[{label:(0,n.jsx)(c.x6,{i18nKey:"more-action.report",ns:"chat",defaults:"Report Issue"}),type:0}];function eT(e){let{triggerButton:t,setDropdownIsOpen:s}=e,i=(0,eI.P)(L.A("setReportDialogIsOpen")),a=e=>{0===e?i(!0):(0,C.vV)("more-actions-dropdown","Non supported ActionType clicked in MoreActionsDropdown")};return(0,n.jsxs)(er.rI,{onOpenChange:e=>{s(e)},children:[(0,n.jsx)(er.ty,{asChild:!0,children:t}),(0,n.jsx)(er.SQ,{side:"bottom",align:"end",sideOffset:6,className:"min-w-36 space-y-0.5",children:eC.map((e,t)=>(0,n.jsx)(er._2,{className:(0,T.cn)("flex items-center gap-2"),onClick:()=>a(e.type),children:e.label},t))})]})}var eE=s(5174),eA=s(69007);let eR=[],eP="opacity-0 group-focus-within:opacity-100 group-hover:opacity-100 [.last-response_&]:opacity-100 disabled:opacity-0 group-focus-within:disabled:opacity-60 group-hover:disabled:opacity-60 [.last-response_&]:disabled:opacity-60",ez="opacity-100",eM=(0,o.memo)(e=>{var t,s;let{responseFamily:i=eR,selectedId:a,streamingResponse:r,onPivotResponse:M,onEditSubmit:X,readOnly:et,isIncognito:es,queryBarHeight:en,isLastResponse:ei}=e,{t:er,i18n:eo}=(0,c.Bd)("chat"),ec=(0,N.c)(),ed=(0,w.h)(),{client:eu}=(0,z.useStatsigClient)(),ep=(0,S.K)(),[ex,eh]=(0,o.useState)(),[em,ef]=(0,o.useState)(),[eg,ev]=(0,o.useState)(!1),ej=(0,o.useRef)(null),eI=(0,Y.aP)(L.A("usingExperiment")),e_=(0,E.d)(L.A("fetchGetAsset")),eC=(0,Y.aP)(L.A("isRateLimited")),eM=(0,Y.aP)(L.A("experiments")),[eO,eB]=(0,o.useState)(!1),eU=(0,F.usePathname)(),eq=null==eU?void 0:eU.includes("/share/"),[eH,eF]=(0,o.useState)(!1),[eL,eW]=(0,o.useState)(!1),eK=(0,o.useMemo)(()=>i.findIndex(e=>e.responseId===a),[i,a]),eV=null==(t=i[eK])?void 0:t.responseId;if(!eV)throw Error("Response not found in family");let e$=(0,R.A3)(e=>e.byId[eV]);if(r&&(e$.streamingImageById=r.streamingImageById),!e$)throw Error("Response not found");let eY=(0,A.w)(e=>e$.conversationId?e.byId[e$.conversationId]:void 0),{getPersonaForConversation:eG}=(0,k.v5)(),eJ=eG(eY),[eX,eZ]=(0,o.useState)({}),eQ=(0,o.useCallback)(()=>{var e;null==(e=e$.fileAttachments)||e.forEach(e=>{e in eX||e_({assetId:e}).then(t=>{eZ(W.A(K.A(e),t))}).catch(t=>{if(t.errorMessage.message.includes("An unexpected database error occurred when creating AssetMetadata.")||t.errorMessage.message.includes("attempts to access asset")){(0,C.vV)("response-family:resetFileAttachments",t.errorMessage.message),eZ(W.A(K.A(e),(0,l._k)(e,er("hidden-attachment-name","Hidden attachment"))));return}ep(t)})})},[e$,eX,ep]);(0,o.useEffect)(()=>{eQ()},[e$]),(0,o.useEffect)(()=>{eZ({})},[a,eI]);let e0=(0,o.useCallback)(e=>{eZ(t=>V.A(e.assetId)(t))},[eZ]),{resolvedTheme:e1}=(0,H.D)(),e2="dark"===e1,e4=(0,o.useMemo)(()=>Object.values(eX),[eX]),[e3,e5]=(0,o.useState)(e$.webpageUrls),e6=(0,o.useCallback)(e=>{e5(t=>t.filter(t=>t!==e)||[])},[]),e8="human"===e$.sender,e7=(0,o.useMemo)(()=>!!(e$.error&&e$.error.includes("content-moderated")),[e$.error]),e9=(0,o.useCallback)(async()=>{let e=i[eK-1];M&&e&&(eu.logEvent("pivot_prev_response",e$.responseId,{location:"chat-response",responseId:e$.responseId,conversationId:e$.conversationId}),ef("prev"),await M(e.responseId),ef(void 0))},[M,eK,i,e$,eu]),te=(0,o.useCallback)(async()=>{let e=i[eK+1];M&&e&&(eu.logEvent("pivot_next_response",e$.responseId,{location:"chat-response",responseId:e$.responseId,conversationId:e$.conversationId}),ef("next"),await M(e.responseId),ef(void 0))},[M,eK,i,e$,eu]),tt=(0,o.useCallback)(()=>{eW(!0);let e=(0,J.V)(e$.message);navigator.clipboard.writeText(e).catch(e=>$.oR.error(e.message)),setTimeout(()=>eW(!1),1e3),eu.logEvent("copy_response",e$.responseId,{location:"response-family",responseId:e$.responseId,conversationId:e$.conversationId})},[e$,eu,eo.resolvedLanguage]),ts=(0,o.useCallback)(()=>{eF(e=>!e),eu.logEvent("edit_response",e$.responseId,{location:"chat-response",responseId:e$.responseId,conversationId:e$.conversationId})},[e$,eu]),tn=(0,o.useCallback)(async()=>{var e,t;let s=Y.aP.getState(),n=P.C.getState();eu.logEvent("regenerate_response",e$.responseId,{location:"chat-response",responseId:e$.responseId,conversationId:e$.conversationId,fileAttachments:String((null==(e=e$.fileAttachments)?void 0:e.length)||0),webpageUrls:String((null==(t=e$.webpageUrls)?void 0:t.length)||0),outputMode:s.outputMode,reasoningMode:s.reasoningMode,personalityId:n.userSettings.preferences.selectedSystemPromptId||"",personaId:(null==eJ?void 0:eJ.personaId)||""}),s.sendResponse({message:"",parentResponseId:e$.parentResponseId,conversationId:e$.conversationId,fileAttachmentIds:e$.fileAttachments||[],webpageUrls:e$.webpageUrls,setOpimisticUserResponse:!1,setUserResponse:!1,persona:eJ,enableRetries:ed.ENABLE_AUTO_STREAM_RETRY}).then(e=>{e.length||(0,C.vV)("response-family:handleClickRegenerate","Failed to regenerate model response")}).catch(e=>{(0,C.vV)("response-family:handleClickRegenerate",e)})},[eJ,e$,eu,ed.ENABLE_AUTO_STREAM_RETRY]),{data:ti}=(0,I.$1)(e$.conversationId,!eq),ta=String(!O()(null==ti?void 0:ti.length)),tl=(0,o.useCallback)(e=>{eh(e=>"like"===e?void 0:"like"),eu.logEvent("like_response",null!=e?e:"type-unspecified",{location:"response-family",generatedImageUrls:e$.generatedImageUrls.join(","),responseId:e$.responseId,conversationId:e$.conversationId,type:null!=e?e:"like-dropdown-opened",hasWorkspace:ta})},[e$,eu,ta]),tr=(0,o.useCallback)(e=>{eh(e=>"dislike"===e?void 0:"dislike"),eu.logEvent("dislike_response",null!=e?e:"type-unspecified",{location:"response-family",generatedImageUrls:e$.generatedImageUrls.join(","),responseId:e$.responseId,conversationId:e$.conversationId,type:null!=e?e:"dislike-dropdown-opened",hasWorkspace:ta})},[e$,eu,ta]),to=(0,P.C)(e=>e.userSettings.preferences.displayUserMessageMarkdown),[tc]=(0,o.useState)(to),td=(0,o.useCallback)(e=>{if(!e$.conversationId)return void(0,C.vV)("response-family:handleEditSave","No conversation id found");let t=e.length;if(t>_.H4)return void $.oR.error(er("query-bar.too-long","Character Limit Exceeded: {{currentLength, number(maximumFractionDigits: 0)}}/{{maxLength, number(maximumFractionDigits: 0)}}",{maxLength:_.H4.toFixed(0),currentLength:t.toFixed(0)}));null==X||X(e$.responseId);let s=Y.aP.getState(),n=P.C.getState();eu.logEvent("edit_response_submit",e$.responseId,{location:"chat-response",responseId:e$.responseId,conversationId:e$.conversationId,fileAttachments:String(Object.keys(eX).length||0),webpageUrls:String(e3.length||0),outputMode:s.outputMode,reasoningMode:s.reasoningMode,personalityId:n.userSettings.preferences.selectedSystemPromptId||"",personaId:(null==eJ?void 0:eJ.personaId)||""}),s.sendResponse({message:e,parentResponseId:e$.parentResponseId,conversationId:e$.conversationId,fileAttachmentIds:Object.keys(eX),webpageUrls:e3,setOpimisticUserResponse:!0,setUserResponse:!0,persona:eJ,enableRetries:ed.ENABLE_AUTO_STREAM_RETRY}).then(e=>{e.length||(0,C.vV)("response-family:handleEditSave","Failed to response to edit")}).catch(e=>{(0,C.vV)("response-family:handleEditSave",e)}).finally(()=>eF(!1))},[eJ,e$,eX,e3,ed.ENABLE_AUTO_STREAM_RETRY]),tu=(0,o.useCallback)(()=>{eF(!1),eQ(),e5(e$.webpageUrls||[])},[eQ,e$.webpageUrls]),tp=(0,o.useCallback)((e,t)=>{let s=eM[e],n=eM[+(0==e)];eu.logEvent("user_side_by_side_preference",(null==s?void 0:s.responseId)||"",{index:e.toString(),nonPreferredResponseId:(null==n?void 0:n.responseId)||"",conversationId:(null==s?void 0:s.conversationId)||""});let i=Y.aP.getState();i.setLastMessageId(null==t?void 0:t.responseId),i.setStreamedMessageId(""),i.setUsingExperiment(!1)},[eM,eu]);(0,o.useEffect)(()=>{if(!ej.current)return;let e=new IntersectionObserver(e=>{let[t]=e;ev(t.isIntersecting)},{root:null,rootMargin:"0px",threshold:0}),t=document.createElement("div");return t.style.height="1px",t.style.position="absolute",t.style.bottom="0",t.style.zIndex="1000",ej.current.appendChild(t),e.observe(t),()=>{var s;e.unobserve(t),null==(s=ej.current)||s.removeChild(t),e.disconnect()}},[a]);let tx=[...ek(eN),ew],th=[...ek(eb),ey];if(null!=eV&&eI&&(null==eM?void 0:eM.some(e=>(null==e?void 0:e.responseId)===eV)))return(0,n.jsx)(x.t,{fallbackRender:eD({isUser:e8}),children:(0,n.jsx)(G.$,{children:eM.map((e,t)=>(0,n.jsx)(G.l,{index:t,response:e,isStreaming:!1,onClickPrefer:tp},t))})});if(e$.metadata&&"artifactAction"in e$.metadata)return(0,n.jsx)(x.t,{fallbackRender:eD({isUser:e8}),children:(0,n.jsx)(ee,{response:e$})});let tm=()=>(0,n.jsx)(g.gx,{"aria-label":er("response-action.copy","Copy"),tooltipContent:eL?(0,n.jsx)("p",{children:er("Copied!","Copied!")}):(0,n.jsx)("p",{children:er("Copy","Copy")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary",size:ec?"iconMd":"iconSm",rounded:!0,onClick:tt,className:(0,T.cn)(eP,eO?ez:null),children:(0,n.jsx)(v.p,{children:eL?(0,n.jsx)(D.A,{className:"size-4"}):(0,n.jsx)(h.Td,{className:"size-4"})},eL?"copied":"copy")});return(0,n.jsx)(x.t,{fallbackRender:eD({isUser:e8}),children:(0,n.jsxs)(Q.i,{isUser:e8,ref:ej,children:[(0,n.jsx)(p.a,{hidden:!0}),(0,n.jsx)(Z.s,{isUser:e8,isIncognito:es,children:!et&&eH?(0,n.jsx)(ea,{initialMessage:e$.message,onCancel:tu,onSave:td}):(0,n.jsx)(eE.j,{readOnly:et,response:e$,isStreaming:"streaming"===e$.state||"reconnecting"===e$.state,showMarkdown:e8?tc:void 0,isModerated:e7})}),(0,n.jsx)(u.vO,{response:e$}),e4.length>0?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex flex-row flex-wrap justify-end gap-2 mt-2",children:[eq&&(0,n.jsxs)(y.m_,{children:[(0,n.jsx)(y.k$,{className:"focus:outline-none focus:ring-1 ring-ring rounded-xl",children:(0,n.jsx)(B.A,{size:18,className:"cursor-default text-secondary"})}),(0,n.jsx)(y.ZI,{side:"bottom",children:(0,n.jsx)("p",{className:"my-1 text-sm text-right",children:er("Attachments are hidden for privacy considerations","Attachments are hidden for privacy considerations")})})]}),e4.map(e=>(0,n.jsx)(f.u,{asset:e,onRemoveAsset:eH?e0:void 0,isShared:eq,allowCompact:!0},e.assetId))]})}):null,e$.imageEditUri&&(null!=(s=e4.length)?s:0)===0?(0,n.jsx)(d,{response:e$}):null,ed.ENABLE_WEBPAGE_ATTACHMENTS&&(null==e3?void 0:e3.length)>0?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"flex flex-row flex-wrap justify-end gap-2 mt-2",children:e3.map(e=>(0,n.jsx)(b.i,{url:e,onDetachUrl:eH?e6:void 0},"".concat(e$.responseId,"-").concat(e)))})}):null,e$.error&&!e7&&(0,n.jsx)("div",{className:"flex mt-2 -ml-5",children:(0,n.jsx)(el._,{title:er("Grok was unable to finish replying.errorMessage","Grok was unable to finish replying."),description:er("Grok was unable to finish replying.description","Please try again later or use a different model."),className:e8?"md:mr-0":"ml-4",onRetry:tn})}),!eH&&!eI&&(0,n.jsx)("div",{className:(0,T.cn)("order-first sticky hidden @xl/mainview:-top-3"," @[960px]/mainview:block","top-11 h-0 opacity-0 group-focus-within:opacity-100 group-hover:opacity-100","-mt-2",e8?"-mr-[36px] @lg/mainview:-mr-12":"-ml-[50px] -left-[26px]"),children:(0,n.jsxs)("div",{className:"min-h-7 py-4 flex flex-col gap-0.5",children:[!eg&&e8&&!et&&(0,n.jsx)(g.gx,{tooltipContent:er("Edit","Edit"),tooltipContentProps:{side:e8?"right":"left"},variant:"ghostSecondary",size:ec?"iconMd":"iconSm",rounded:!0,onClick:ts,"aria-label":er("response-action.edit","Edit"),disabled:eC,children:(0,n.jsx)(v.p,{children:(0,n.jsx)(h.rZ,{className:"size-4"})},"edit")}),!eg&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(g.gx,{tooltipContent:eL?(0,n.jsx)("p",{children:er("Copied!","Copied!")}):(0,n.jsx)("p",{children:er("Copy","Copy")}),tooltipContentProps:{side:e8?"right":"left"},variant:"ghostSecondary",size:ec?"iconMd":"iconSm",rounded:!0,onClick:tt,children:(0,n.jsx)(v.p,{children:eL?(0,n.jsx)(D.A,{className:"size-4"}):(0,n.jsx)(h.Td,{className:"size-4"})},eL?"copied":"copy")})})]})}),!eH&&!eI&&(0,n.jsx)("div",{className:(0,T.cn)("flex flex-row flex-wrap w-full",e8?"justify-end":"justify-between",ei?"last-response":""),children:(0,n.jsxs)("div",{className:(0,T.cn)("flex items-center gap-[2px] w-max","rounded-lg text-xs bg-background","pb-2 px-2",e8?"end-4 -mr-2":"start-0 md:start-3 -ml-4",ec&&"-mt-2 opacity-100"),style:{bottom:"".concat(en,"px")},children:[!et&&e8?(0,n.jsx)(g.gx,{tooltipContent:(0,n.jsx)("p",{children:er("Edit","Edit")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary","aria-label":er("response-action.edit","Edit"),size:ec?"iconMd":"iconSm",rounded:!0,onClick:ts,disabled:eC,className:(0,T.cn)(eP,eO?ez:null),children:(0,n.jsx)(v.p,{children:(0,n.jsx)(h.rZ,{className:"size-4"})},"edit")}):null,e8?tm():null,i.length>1?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.gx,{tooltipContent:(0,n.jsx)("p",{children:er("go to previously sent message","Previous message")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary","aria-label":er("go to previously sent message","Previous message"),size:ec?"iconMd":"iconSm",rounded:!0,disabled:0===eK||"prev"===em,onClick:e9,children:(0,n.jsx)(v.p,{children:"prev"===em?(0,n.jsx)(j.y,{size:"xs"}):(0,n.jsx)(h.YJ,{size:20})},"prev"===em?"loading":"prev")}),(0,n.jsxs)("span",{className:(0,T.cn)("px-0.5"),children:[eK+1," / ",i.length]}),(0,n.jsx)(g.gx,{tooltipContent:(0,n.jsx)("p",{children:er("go to next sent message","Next message")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary","aria-label":er("go to next sent message","Next message"),size:ec?"iconMd":"iconSm",rounded:!0,disabled:eK===i.length-1||"next"===em,onClick:te,children:(0,n.jsx)(v.p,{children:"next"===em?(0,n.jsx)(j.y,{size:"xs"}):(0,n.jsx)(h.vK,{size:20})},"next"===em?"loading":"next")})]}):null,et||e8?null:(0,n.jsx)(g.gx,{tooltipContent:(0,n.jsx)("p",{children:er("Regenerate","Regenerate")}),tooltipContentProps:{side:"bottom"},variant:"ghostSecondary","aria-label":"Regenerate",size:ec?"iconMd":"iconSm",rounded:!0,disabled:eC,onClick:tn,className:(0,T.cn)(eP,eO?ez:null),children:(0,n.jsx)(v.p,{children:(0,n.jsx)(h.V$,{className:"size-4"})},"regenerate")}),e8?null:tm(),!et&&!e8&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(eA.w,{variant:"ghostSecondary",size:ec?"iconMd":"iconSm",rounded:!0,conversationId:e$.conversationId,responseId:e$.responseId,iconProps:{className:"size-4"},className:(0,T.cn)(eP,eO?ez:null)})}),!et&&e$.memoryReferences&&(0,n.jsx)(m.s,{responseId:e$.responseId,memoryReferences:e$.memoryReferences,className:(0,T.cn)(eP,eO?ez:null)}),!et&&!e8&&(0,n.jsx)(eS,{handleClick:tl,showDropdown:"like"!==ex,setDropdownIsOpen:eB,options:th,triggerButton:(0,n.jsx)(g.gx,{"aria-label":er("response-action.like","Like"),variant:"ghostSecondary",size:ec?"iconMd":"iconSm",rounded:!0,tooltipContent:(0,n.jsx)("p",{children:er("Love this","Love this")}),tooltipContentProps:{side:"bottom"},className:(0,T.cn)(eP,eO?ez:null),children:(0,n.jsx)(v.p,{children:"like"===ex?(0,n.jsx)(h.Ge,{className:(0,T.cn)("size-4 text-green-500",{"fill-green-200":e2,"fill-green-100":!e2})}):(0,n.jsx)(h.Ge,{className:"size-4"})},"like"===ex?"like":"dislike")})}),!et&&!e8&&(0,n.jsx)(eS,{handleClick:tr,showDropdown:"dislike"!==ex,options:tx,setDropdownIsOpen:eB,triggerButton:(0,n.jsx)(g.gx,{"aria-label":er("response-action.dislike","Dislike"),variant:"ghostSecondary",size:ec?"iconMd":"iconSm",rounded:!0,tooltipContent:(0,n.jsx)("p",{children:er("Needs improvement","Needs improvement")}),tooltipContentProps:{side:"bottom"},className:(0,T.cn)(eP,eO?ez:null),children:(0,n.jsx)(v.p,{children:"dislike"===ex?(0,n.jsx)(h.d2,{className:(0,T.cn)("size-4 text-blue-500",{"fill-blue-200":e2,"fill-blue-100":!e2})}):(0,n.jsx)(h.d2,{className:"size-4"})},"dislike"===ex?"dislike":"like")})}),!et&&!e8&&ed.ENABLE_IN_APP_REPORTING&&(0,n.jsx)(eT,{handleClickDislike:tr,setDropdownIsOpen:eB,triggerButton:(0,n.jsx)(g.gx,{"aria-label":er("response-action.more-actions","More actions"),variant:"ghostSecondary",rounded:!0,size:ec?"iconMd":"iconSm",tooltipContent:(0,n.jsx)("p",{children:er("More",{defaultValue:"More"})}),tooltipContentProps:{side:"bottom"},className:(0,T.cn)(eP,eO?ez:null),children:(0,n.jsx)(v.p,{children:(0,n.jsx)(U.A,{className:(0,T.cn)("size-4")})},"more-actions")})}),!et&&!e8&&ed.SHOW_RESPONSE_LOAD_TIMER&&null!=e$.generationTimeMs&&(0,n.jsx)("div",{className:(0,T.cn)("px-1 text-secondary",(0,T.cn)(eP,eO?ez:null)),children:er("response-generation-time-seconds",{count:e$.generationTimeMs/1e3,defaultValue_one:"{{count, number(maximumFractionDigits: 2)}}s",defaultValue_other:"{{count, number(maximumFractionDigits: 2)}}s"})}),!e8&&e$.partial&&(0,n.jsxs)("div",{className:(0,T.cn)("flex items-center gap-1 px-1 text-secondary",(0,T.cn)(eP,eO?ez:null)),children:[(0,n.jsx)(q.A,{size:16}),er("Interrupted","Interrupted")]})]})})]})})},(e,t)=>{var s,n;return e.onPivotResponse===t.onPivotResponse&&e.selectedId===t.selectedId&&(null==(s=e.responseFamily)?void 0:s.map(e=>e.responseId).join(","))===(null==(n=t.responseFamily)?void 0:n.map(e=>e.responseId).join(","))&&e.queryBarHeight===t.queryBarHeight&&e.isLastResponse===t.isLastResponse});function eO(e){let{isUser:t}=e,{t:s}=(0,c.Bd)("chat");return(0,n.jsx)(Q.i,{isUser:t,children:(0,n.jsx)(Z.s,{isUser:t,children:(0,n.jsx)("p",{children:s("Something went wrong rendering this message","Something went wrong rendering this message")})})})}function eD(e){let{isUser:t}=e;return e=>{let{error:s,resetErrorBoundary:i}=e;return(0,n.jsx)(eO,{isUser:t,error:s,resetErrorBoundary:i})}}eM.displayName="ResponseFamily"},19728:(e,t,s)=>{s.d(t,{$:()=>c,l:()=>d});var n=s(79342),i=s(56691),a=s(61312),l=s(88382),r=s(65146),o=s(5174);function c(e){let{children:t}=e,{t:s}=(0,r.Bd)("chat");return(0,n.jsx)("div",{className:(0,a.cn)("relative group flex flex-col justify-center w-full pb-2 lg:max-w-4/5 message-row","items-start"),children:(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("p",{className:"text-center text-lg font-bold mb-2",children:s("Which response do you prefer?","Which response do you prefer?")}),(0,n.jsx)("p",{className:"text-center mb-4",children:s("This will help make Grok better.","This will help make Grok better.")}),(0,n.jsx)("div",{className:"flex justify-center ",children:t})]})})}function d(e){let{index:t,response:s,isStreaming:c,onClickPrefer:d}=e,{t:u}=(0,r.Bd)("chat"),p=(0,l.useCallback)(()=>{d(t,s)},[d]);return(0,n.jsxs)("div",{className:(0,a.cn)("w-1/2 max-w-3xl flex flex-col shrink-0 grow-0 gap-2 justify-between px-6","border-r border-toggle-border last:border-r-0"),children:[(0,n.jsxs)("p",{className:"font-bold text-primary text-sm",children:[u("Response","Response"),t+1]}),(0,n.jsx)("div",{className:(0,a.cn)("flex-1","prose dark:prose-invert","w-full max-w-none","text-sm"),children:(0,n.jsx)(o.j,{response:s,isStreaming:c,showMarkdown:!0})}),(0,n.jsx)(i.$n,{variant:"card",size:"lg",onClick:p,children:u("Prefer this response","Prefer this response")})]},t)}},44428:(e,t,s)=>{s.d(t,{a:()=>l});var n=s(79342),i=s(56691),a=s(88382);function l(e){let{error:t,hidden:s}=e,[l,r]=(0,a.useState)(!1);if(l)if(t)throw t;else throw Error("Triggered error");return s?null:(0,n.jsx)(i.$n,{className:"absolute top-1/2 left-2 z-[100]",onClick:()=>r(!0),children:"Trigger Error"})}},66587:(e,t,s)=>{s.d(t,{_:()=>f});var n=s(79342),i=s(56691),a=s(17703),l=s(61312),r=s(56096),o=s(40938),c=s(82059),d=s(35299),u=s(32171),p=s.n(u),x=s(88382),h=s(65146),m=s(92539);function f(e){let{title:t,description:s,onRetry:u,onContinue:f,onCancel:g,supportUrl:v,className:j}=e,{t:y}=(0,h.Bd)("chat");return(0,x.useEffect)(()=>{let e=r.x.getState().bestSubscription,t=m.aP.getState();(0,a.N8)("error-response",{type:"error_response_viewed",subscriptionTier:e||"unknown",modelId:t.activeModelId,modelMode:t.reasoningMode})},[]),(0,n.jsx)("div",{className:(0,l.cn)("w-full max-w-[48rem]"),children:(0,n.jsx)(d.P.div,{initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},exit:{translateY:5,opacity:0},className:(0,l.cn)("w-fit","p-4 bg-card","shadow-sm","border border-input-border rounded-2xl","ml-4 md:mx-4",j),children:(0,n.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,n.jsx)(o.A,{className:(0,l.cn)("h-5 w-5 flex-shrink-0")}),(0,n.jsxs)("div",{className:"flex-1 max-w-96",children:[(0,n.jsx)("div",{className:"text-primary text-sm",children:t}),s&&(0,n.jsx)("div",{className:"text-secondary text-sm",children:s}),v&&(0,n.jsxs)("div",{className:"text-secondary text-sm",children:[y("Try again or ","Try again or "),(0,n.jsx)(p(),{href:v,target:"_blank",rel:"noopener noreferrer",className:"text-secondary underline decoration-dotted decoration-secondary/50 underline-offset-4 hover:text-primary",children:y("Contact Support","Contact Support")})]})]}),(u||g||f)&&(0,n.jsxs)("div",{className:"flex items-center gap-2 sm:pl-8",children:[g&&(0,n.jsx)(i.$n,{variant:"secondary",size:"pill",onClick:g,children:y("Cancel","Cancel")}),u&&(0,n.jsxs)(i.$n,{variant:"secondary",size:"pill",onClick:u,children:[(0,n.jsx)(c.A,{className:"mr-2 h-4 w-4"}),y("Retry","Retry")]}),f&&(0,n.jsxs)(i.$n,{variant:"secondary",size:"pill",onClick:f,children:[(0,n.jsx)(c.A,{className:"mr-2 h-4 w-4"}),y("Continue","Continue")]})]})]})})})}},97141:(e,t,s)=>{s.d(t,{i:()=>a});var n=s(79342),i=s(61312);let a=(0,s(88382).forwardRef)((e,t)=>{let{isUser:s,children:a,className:l}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("relative group flex flex-col justify-center w-full max-w-3xl md:px-4 pb-2 gap-2",s?"items-end":"items-start",l),children:a})})}}]);